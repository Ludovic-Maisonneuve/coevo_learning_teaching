(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    160902,       3954]
NotebookOptionsPosition[    159761,       3932]
NotebookOutlinePosition[    160154,       3948]
CellTagsIndexPosition[    160111,       3945]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"bluek", "=", 
   RowBox[{"RGBColor", "[", "\"\<#004D80\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gray", "=", 
   RowBox[{"RGBColor", "[", "\"\<#E6E6E6\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mathematicagray", "=", 
   RowBox[{"RGBColor", "[", "\"\<#666666\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"colorIL", "=", 
   RowBox[{"RGBColor", "[", "\"\<#EE4F70\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"colorOL", "=", " ", 
   RowBox[{"RGBColor", "[", "\"\<#59CF86\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"colorVL", " ", "=", " ", 
   RowBox[{"RGBColor", "[", "\"\<#48A8DF\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"style", "=", 
   RowBox[{"Directive", "[", 
    RowBox[{
     RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
     RowBox[{"FontSize", "\[Rule]", "35"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.919915678745884*^9, 3.919915680336835*^9}, 
   3.920000780137065*^9, {3.920091251525975*^9, 3.92009127304193*^9}, 
   3.92009137730062*^9, {3.920533221662362*^9, 3.920533240738475*^9}, 
   3.9205332829434557`*^9, {3.942456711118347*^9, 3.942456715595953*^9}, {
   3.942812335574067*^9, 
   3.9428123380539503`*^9}},ExpressionUUID->"a0f9afcd-dd60-4da7-b40b-\
5f7e82d88f2f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NumSeq", "[", 
   RowBox[{"min_", ",", " ", "max_", ",", " ", "nstep_"}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{"x", ",", " ", 
    RowBox[{"{", 
     RowBox[{"x", ",", "min", ",", " ", "max", ",", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"max", "-", "min"}], ")"}], "/", "nstep"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeRule", "[", 
    RowBox[{"targets_", ",", " ", "subs_"}], "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", " ", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "&"}], ",", " ", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"targets", ",", " ", "subs"}], "}"}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DropParam", "[", 
    RowBox[{"params_", ",", " ", "param_"}], "]"}], ":=", 
   RowBox[{"Drop", "[", 
    RowBox[{"params", ",", 
     RowBox[{"First", "[", 
      RowBox[{"Position", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", " ", "params"}], 
         "]"}], ",", " ", "param"}], "]"}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParamSerialize", "[", 
   RowBox[{"params_", ",", " ", "param_", ",", " ", "seq_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"params2", ",", " ", "paramlist"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"params2", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{"params", ",", 
        RowBox[{"First", "[", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", " ", "params"}], 
            "]"}], ",", " ", "param"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"paramlist", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"param", " ", "\[Rule]", " ", "#"}], "}"}], ",", " ", 
           "params2"}], "]"}], "&"}], ",", " ", "seq"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "paramlist"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.904893336918106*^9, 3.904893364842763*^9}, {
   3.904903832903755*^9, 3.90490383343701*^9}, {3.9053255763749113`*^9, 
   3.905325593365987*^9}, {3.9053289796797*^9, 3.90532899808144*^9}, {
   3.905419571690062*^9, 3.905419578151766*^9}, {3.905419617378564*^9, 
   3.905419635591043*^9}, {3.905419890341957*^9, 3.905419890659937*^9}, 
   3.905506410283573*^9, {3.9055064690493107`*^9, 3.905506578825881*^9}, {
   3.905510686389717*^9, 3.9055106893796177`*^9}, {3.906432645437202*^9, 
   3.9064326470169077`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"566f8f1a-1f53-4652-bdeb-db47045c6e65"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SelGradIterate", "[", 
    RowBox[{"S_", ",", " ", "traits_", ",", " ", "params_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "vars", ",", "init", ",", "bounds", ",", "Sparams", ",", "G", ",", 
       "myclip", ",", " ", "newval"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"vars", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"First", "[", "#", "]"}], "&"}], ",", " ", "traits"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"init", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", " ", "traits"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"bounds", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"{", 
             RowBox[{"3", ",", "4"}], "}"}], "]"}], "]"}], "&"}], ",", " ", 
         "traits"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Sparams", "=", 
       RowBox[{
        RowBox[{"S", "/.", "params"}], "//", "Simplify"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"G", "=", 
       RowBox[{"0.001", " ", 
        RowBox[{"IdentityMatrix", "[", 
         RowBox[{"Length", "[", "S", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"myclip", "[", 
        RowBox[{"val_", ",", " ", "pos_"}], "]"}], ":=", " ", 
       RowBox[{"Clip", "[", 
        RowBox[{"val", ",", " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{"bounds", "[", 
           RowBox[{"[", "pos", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newval", "[", "val_", "]"}], ":=", " ", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"MapIndexed", "[", 
          RowBox[{"myclip", ",", " ", 
           RowBox[{"val", "+", 
            RowBox[{"G", ".", 
             RowBox[{"(", 
              RowBox[{"Sparams", "/.", 
               RowBox[{"MakeRule", "[", 
                RowBox[{"vars", ",", " ", "val"}], "]"}]}], ")"}]}]}]}], 
          "]"}], "/.", 
         RowBox[{"MakeRule", "[", 
          RowBox[{"vars", ",", " ", "val"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"NestWhileList", "[", 
       RowBox[{"newval", ",", "init", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"EuclideanDistance", "[", 
           RowBox[{"#1", ",", "#2"}], "]"}], ">", 
          RowBox[{"10", "^", 
           RowBox[{"-", "8"}]}]}], "&"}], ",", "2", ",", "500000"}], 
       "]"}]}]}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetReachedStrat", "[", 
    RowBox[{"S_", ",", " ", "traits_", ",", " ", "params_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "timedyn", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"timedyn", " ", "=", " ", 
       RowBox[{"SelGradIterate", "[", 
        RowBox[{"S", ",", " ", "traits", ",", " ", "params"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[Beta]o", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Epsilon]"}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Rho]"}], ")"}]}]}], ">", "1"}], "\[Or]", 
          RowBox[{
           RowBox[{"\[Beta]v0", 
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Epsilon]"}], ")"}]}], ">", "1"}]}], "/.", 
         "params"}], ",", 
        RowBox[{"Last", "[", "timedyn", "]"}], ",", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"Length", "[", "S", "]"}]}], "]"}]}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetReachedStratTwoPhases", "[", 
   RowBox[{"S_", ",", " ", "traits_", ",", " ", "params_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "timedyn0", ",", "timedyn", ",", "paramsDrop", ",", "params0", ",", "v0",
       ",", "o0", ",", "\[Tau]0"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"paramsDrop", "=", 
      RowBox[{"DropParam", "[", 
       RowBox[{"params", ",", "\[Beta]\[Tau]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"params0", "=", 
      RowBox[{"Insert", "[", 
       RowBox[{"paramsDrop", ",", 
        RowBox[{"\[Beta]\[Tau]", "\[Rule]", "0"}], ",", 
        RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"timedyn0", " ", "=", " ", 
      RowBox[{"SelGradIterate", "[", 
       RowBox[{"S", ",", " ", "traits", ",", " ", "params0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v0", ",", "o0", ",", "\[Tau]0"}], "}"}], "=", 
      RowBox[{"Last", "[", "timedyn0", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"traitsSecondPhase", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v", ",", " ", "v0", ",", " ", "0", ",", " ", 
          RowBox[{"1", "-", "o"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"o", ",", " ", "o0", ",", " ", "0", ",", " ", 
          RowBox[{"1", "-", "v"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Tau]", ",", " ", "0", ",", " ", "0", ",", " ", "100"}], 
         "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"timedyn", " ", "=", " ", 
      RowBox[{"SelGradIterate", "[", 
       RowBox[{"S", ",", " ", "traitsSecondPhase", ",", " ", "params"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[Beta]o", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Epsilon]"}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Rho]"}], ")"}]}]}], ">", "1"}], "\[Or]", 
         RowBox[{
          RowBox[{"\[Beta]v0", 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Epsilon]"}], ")"}]}], ">", "1"}]}], "/.", 
        "paramsDrop"}], ",", 
       RowBox[{"Last", "[", "timedyn", "]"}], ",", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "S", "]"}]}], "]"}]}], "]"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.904893336918106*^9, 3.904893364842763*^9}, {
   3.904903832903755*^9, 3.90490383343701*^9}, {3.9053255763749113`*^9, 
   3.905325593365987*^9}, {3.9053289796797*^9, 3.90532899808144*^9}, 
   3.905414450237*^9, {3.9054183246663933`*^9, 3.90541832526781*^9}, {
   3.9054198536071177`*^9, 3.905419867613804*^9}, {3.9054199182064743`*^9, 
   3.905419935405685*^9}, {3.905420037446307*^9, 3.9054200607491503`*^9}, {
   3.9054202135267477`*^9, 3.9054202502299423`*^9}, {3.905420471887838*^9, 
   3.905420616561092*^9}, {3.905420677000944*^9, 3.905420851968822*^9}, {
   3.905503659473555*^9, 3.905503675870145*^9}, {3.9055037128541393`*^9, 
   3.9055037222715473`*^9}, {3.905503990826414*^9, 3.90550408055234*^9}, {
   3.905504159802396*^9, 3.9055042695090427`*^9}, {3.9055043152469473`*^9, 
   3.905504330605955*^9}, {3.90550438199111*^9, 3.9055044627735147`*^9}, {
   3.905504604552329*^9, 3.905504606863452*^9}, {3.9055049750481443`*^9, 
   3.9055049772900333`*^9}, {3.905505028270926*^9, 3.9055050582163887`*^9}, 
   3.905505124067137*^9, {3.9055052136563377`*^9, 3.905505217280313*^9}, {
   3.905505904008382*^9, 3.905505922623595*^9}, {3.9055059747523746`*^9, 
   3.905505975295663*^9}, {3.9055070646440477`*^9, 3.9055070686048107`*^9}, {
   3.905508325923934*^9, 3.905508370494913*^9}, {3.906003158820961*^9, 
   3.90600319467909*^9}, {3.9064343212343493`*^9, 3.906434322921124*^9}, {
   3.906435990687357*^9, 3.906435993554813*^9}, {3.909732424946423*^9, 
   3.909732447346715*^9}, {3.915079732531502*^9, 3.915079749921768*^9}, 
   3.9150798010754004`*^9, {3.915079872389552*^9, 3.915079889235066*^9}, {
   3.915079990236575*^9, 3.915080007196534*^9}, {3.915080091324438*^9, 
   3.915080091603312*^9}, 3.915080159143464*^9, {3.915080266468961*^9, 
   3.915080290595313*^9}, {3.915080583843487*^9, 3.915080602861524*^9}, {
   3.915080807943791*^9, 3.9150808131648493`*^9}, {3.9150808569782753`*^9, 
   3.915080911717935*^9}, 3.9150874539598703`*^9, {3.915087613736299*^9, 
   3.915087614236722*^9}, {3.91509612757607*^9, 3.915096211119109*^9}, {
   3.9150962613853207`*^9, 3.9150962920447197`*^9}, {3.9150963729481163`*^9, 
   3.915096377192114*^9}, {3.9151654096390257`*^9, 3.915165471010017*^9}, {
   3.915165713680003*^9, 3.915165731817513*^9}, {3.919334433764304*^9, 
   3.919334445226392*^9}, {3.91933448444401*^9, 3.9193345664889174`*^9}, {
   3.919334596630526*^9, 3.9193346016292973`*^9}, {3.9193346928627043`*^9, 
   3.919334786333387*^9}, {3.919334868374175*^9, 3.919335040507605*^9}, {
   3.9193351211554623`*^9, 3.919335186197235*^9}, {3.924582040644668*^9, 
   3.924582058995219*^9}, {3.927787020914283*^9, 3.927787032621257*^9}, {
   3.927787434609077*^9, 3.927787459366123*^9}, {3.9277874937269173`*^9, 
   3.927787497189467*^9}, {3.92778824611414*^9, 3.927788298832251*^9}, {
   3.927788348036379*^9, 3.927788361016079*^9}, 3.9277886038989477`*^9, 
   3.9277887638557377`*^9, 3.927788931103344*^9, {3.927788979854519*^9, 
   3.927788982661633*^9}, 3.927789085021051*^9, 3.9277895831176157`*^9, {
   3.927789639627812*^9, 3.927789640836956*^9}, {3.927793603697358*^9, 
   3.927793623919868*^9}, 3.92789837132126*^9, 3.927905734866507*^9, {
   3.927905930090745*^9, 3.927905931034005*^9}, {3.9279062201146193`*^9, 
   3.927906227653241*^9}, {3.942456779114498*^9, 3.9424567791402493`*^9}, {
   3.942812281387268*^9, 
   3.9428122829899683`*^9}},ExpressionUUID->"88dc340d-32af-4189-9569-\
9b94a0b6ea1d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PlotLearningScheduleParamLogScale", "[", 
   RowBox[{"datav_", ",", "datao_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "onum", ",", " ", "vnum", ",", "ymin", ",", "ymax", ",", " ", "A", ",", 
      " ", "style", ",", " ", "blue", ",", " ", "B"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"onum", "=", 
      RowBox[{"Interpolation", "[", "datao", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vnum", " ", "=", 
      RowBox[{"Interpolation", "[", "datav", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ymin", "=", 
      RowBox[{"Log", "[", 
       RowBox[{"datao", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ymax", "=", 
      RowBox[{"Log", "[", 
       RowBox[{"datao", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"A", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"x", "<", " ", 
           RowBox[{"vnum", "[", 
            RowBox[{"Exp", "[", "y", "]"}], "]"}]}], ",", "0", ",", "  ", 
          RowBox[{
           RowBox[{"vnum", "[", 
            RowBox[{"Exp", "[", "y", "]"}], "]"}], "<=", " ", "x", "<", 
           RowBox[{
            RowBox[{"onum", "[", 
             RowBox[{"Exp", "[", "y", "]"}], "]"}], "+", 
            RowBox[{"vnum", "[", 
             RowBox[{"Exp", "[", "y", "]"}], "]"}]}]}], " ", ",", "1", ",", 
          " ", 
          RowBox[{"x", ">=", 
           RowBox[{
            RowBox[{"onum", "[", 
             RowBox[{"Exp", "[", "y", "]"}], "]"}], " ", "+", 
            RowBox[{"vnum", "[", 
             RowBox[{"Exp", "[", "y", "]"}], "]"}]}]}], " ", ",", "2"}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "1", ",", "0", ",", 
          RowBox[{"-", "0.005"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", "ymin", ",", "ymax", ",", "0.01"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"style", "=", 
      RowBox[{"Directive", "[", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "35"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"blue", "=", 
      RowBox[{"RGBColor", "[", "\"\<#0A71B7\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"B", "=", 
      RowBox[{"ArrayPlot", "[", 
       RowBox[{"A", ",", 
        RowBox[{"ColorRules", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"2", "->", "colorIL"}], ",", 
           RowBox[{"1", "->", "colorOL"}], ",", 
           RowBox[{"0", "->", "colorVL"}]}], "}"}]}], ",", 
        RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
        RowBox[{"DataRange", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ymin", ",", "ymax"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", " ", 
        RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", " ", 
        RowBox[{"LabelStyle", "\[Rule]", "style"}], ",", " ", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ymin", ",", "ymax"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"B", ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", "style"}], ",", 
       RowBox[{"AxesOrigin", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0.5", ",", "1"}], "}"}], ",", "None"}], "}"}],
           ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"ymin", ",", " ", 
                RowBox[{"Exp", "[", "ymin", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"ymax", ",", " ", 
                RowBox[{"Exp", "[", "ymax", "]"}]}], "}"}], ",", 
              RowBox[{"Exp", "[", "ymax", "]"}]}], "}"}], ",", "None"}], 
           "}"}]}], "}"}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.90619711405597*^9, 3.9061971566030207`*^9}, {
   3.906197211653398*^9, 3.9061973107938833`*^9}, {3.90619738919695*^9, 
   3.9061974646747437`*^9}, {3.9061975369747887`*^9, 3.906197540667992*^9}, {
   3.906779799451881*^9, 3.906779832490952*^9}, {3.906780413968938*^9, 
   3.906780417432046*^9}, {3.9073821370068398`*^9, 3.9073821463541183`*^9}, {
   3.907382327346972*^9, 3.907382329136683*^9}, 3.910240156328664*^9, 
   3.9201098818872013`*^9, {3.920110743856763*^9, 3.920110750943424*^9}, 
   3.920110956921361*^9, {3.9201109873762283`*^9, 3.92011099937961*^9}, {
   3.920365439677125*^9, 3.920365440172967*^9}, {3.92053329310492*^9, 
   3.920533311686339*^9}, {3.9205353704670258`*^9, 3.920535375165792*^9}, {
   3.927799234125231*^9, 3.927799234547028*^9}, {3.927887120076482*^9, 
   3.927887120562941*^9}, {3.942456779149349*^9, 3.9424567792752247`*^9}, 
   3.942812128178668*^9},ExpressionUUID->"25884e0c-6520-43fb-abfb-\
c00293331c81"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetParamImpactLogScaleWithKnowledgeAndFecundity", "[", 
   RowBox[{
   "S_", ",", "H_", ",", " ", "keq_", ",", " ", "Keq_", ",", "fe_", ",", " ", 
    "traits_", ",", " ", "params_", ",", " ", "param_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "vars", ",", "par", ",", "paramsDrop", ",", "dataInter", ",", " ", 
      "data", ",", "datak", ",", "dataK", ",", "dataH", ",", "datafe", ",", 
      " ", "imax", ",", " ", "array", ",", " ", "datatraits"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"vars", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"First", "[", "#", "]"}], "&"}], ",", " ", "traits"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"par", "=", 
      RowBox[{"param", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"paramsDrop", "=", 
      RowBox[{"DropParam", "[", 
       RowBox[{"params", ",", "par"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"imax", "=", " ", 
      RowBox[{"param", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"array", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Exp", "[", "i", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", 
          RowBox[{"Log", "[", 
           RowBox[{"param", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "  ", 
          RowBox[{"Log", "[", 
           RowBox[{"param", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Log", "[", 
              RowBox[{"param", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "]"}], "-", 
             RowBox[{"Log", "[", 
              RowBox[{"param", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"param", "[", 
              RowBox[{"[", "4", "]"}], "]"}], "-", "1"}], ")"}]}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"dataInter", " ", "=", " ", 
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"array", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"GetReachedStrat", "[", 
           RowBox[{"S", ",", " ", "traits", ",", " ", 
            RowBox[{"Flatten", "[", " ", 
             RowBox[{"Insert", "[", 
              RowBox[{"paramsDrop", ",", 
               RowBox[{"{", 
                RowBox[{"par", "\[Rule]", 
                 RowBox[{"array", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "imax", ",", "1"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"data", " ", "=", " ", 
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"array", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"dataInter", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2", ",", "k"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", 
          RowBox[{"Length", "[", "S", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "imax", ",", "1"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"dataH", " ", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"array", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"Max", "[", 
           RowBox[{"Eigenvalues", "[", 
            RowBox[{"Simplify", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"H", "/.", "paramsDrop"}], "/.", 
               RowBox[{"MakeRule", "[", 
                RowBox[{"vars", ",", 
                 RowBox[{"data", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "i", ",", "2"}], "]"}], "]"}]}], 
                "]"}]}], "/.", 
              RowBox[{"{", 
               RowBox[{"par", "\[Rule]", 
                RowBox[{"array", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "imax", ",", "1"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"datak", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"array", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"keq", "/.", "paramsDrop"}], "/.", 
             RowBox[{"MakeRule", "[", 
              RowBox[{"vars", ",", 
               RowBox[{"data", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "i", ",", "2"}], "]"}], "]"}]}], "]"}]}],
             "/.", 
            RowBox[{"{", 
             RowBox[{"par", "\[Rule]", 
              RowBox[{"array", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "imax", ",", "1"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"dataK", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"array", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Keq", "/.", "paramsDrop"}], "/.", 
             RowBox[{"MakeRule", "[", 
              RowBox[{"vars", ",", 
               RowBox[{"data", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "i", ",", "2"}], "]"}], "]"}]}], "]"}]}],
             "/.", 
            RowBox[{"{", 
             RowBox[{"par", "\[Rule]", 
              RowBox[{"array", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "imax", ",", "1"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"datafe", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"array", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"fe", "/.", "paramsDrop"}], "/.", 
             RowBox[{"MakeRule", "[", 
              RowBox[{"vars", ",", 
               RowBox[{"data", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "i", ",", "2"}], "]"}], "]"}]}], "]"}]}],
             "/.", 
            RowBox[{"{", 
             RowBox[{"par", "\[Rule]", 
              RowBox[{"array", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "imax", ",", "1"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "data", ",", "dataH", ",", "datak", ",", "dataK", ",", "datafe"}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.915521517860417*^9, 3.915521548627461*^9}, {
  3.9278857888080482`*^9, 3.927885796457712*^9}, {3.927885826487708*^9, 
  3.92788606667936*^9}, {3.927886234201908*^9, 3.92788623501858*^9}, {
  3.927886273341523*^9, 3.92788627977085*^9}, {3.9428120402971773`*^9, 
  3.9428120602298813`*^9}},ExpressionUUID->"e69ae01a-cf35-4f30-b1af-\
3d4787435a90"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Get2ParamImpactLogScaleOneDim", "[", 
    RowBox[{
    "S_", ",", "H_", ",", " ", "keq_", ",", " ", "Keq_", ",", "fe_", ",", " ",
      "traits_", ",", " ", "params_", ",", " ", "param1_", ",", " ", 
     "param2_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "vars", ",", "par1", ",", "par2", ",", "paramsDrop", ",", " ", 
       "dataInt", ",", "data", ",", "datak", ",", "dataK", ",", "dataH", ",", 
       "datafe", ",", " ", "imax1", ",", " ", "imax2", ",", " ", "array1", 
       ",", "array2", ",", " ", "datatraits"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"vars", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"First", "[", "#", "]"}], "&"}], ",", " ", "traits"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"par1", "=", 
       RowBox[{"param1", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"par2", "=", 
       RowBox[{"param2", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"paramsDrop", "=", 
       RowBox[{"DropParam", "[", 
        RowBox[{
         RowBox[{"DropParam", "[", 
          RowBox[{"params", ",", "par1"}], "]"}], ",", "par2"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"LaunchKernels", "[", "10", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"imax1", "=", " ", 
       RowBox[{"param1", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"array1", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Exp", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", 
           RowBox[{"Log", "[", 
            RowBox[{"param1", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "  ", 
           RowBox[{"Log", "[", 
            RowBox[{"param1", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log", "[", 
               RowBox[{"param1", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "]"}], "-", 
              RowBox[{"Log", "[", 
               RowBox[{"param1", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"param1", "[", 
               RowBox[{"[", "4", "]"}], "]"}], "-", "1"}], ")"}]}]}], "}"}]}],
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"imax2", "=", " ", 
       RowBox[{"param2", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"array2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"i", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", 
           RowBox[{"param2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "  ", 
           RowBox[{"param2", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"param2", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "-", 
              RowBox[{"param2", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"param2", "[", 
               RowBox[{"[", "4", "]"}], "]"}], "-", "1"}], ")"}]}]}], "}"}]}],
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dataInt", " ", "=", " ", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"array1", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"array2", "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", 
           RowBox[{"GetReachedStrat", "[", 
            RowBox[{"S", ",", " ", "traits", ",", " ", 
             RowBox[{"Flatten", "[", " ", 
              RowBox[{"Insert", "[", 
               RowBox[{"paramsDrop", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"par1", "\[Rule]", 
                   RowBox[{"array1", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
                  RowBox[{"par2", "\[Rule]", 
                   RowBox[{"array2", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], "}"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "imax1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "imax2", ",", "1"}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"data", " ", "=", " ", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"array1", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"array2", "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", 
           RowBox[{"dataInt", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "3", ",", "k"}], "]"}], "]"}]}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"Length", "[", "S", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "imax1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "imax2", ",", "1"}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dataH", " ", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"array1", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"array2", "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", 
           RowBox[{"Max", "[", 
            RowBox[{"Eigenvalues", "[", 
             RowBox[{"Simplify", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"H", "/.", "paramsDrop"}], "/.", 
                RowBox[{"MakeRule", "[", 
                 RowBox[{"vars", ",", 
                  RowBox[{"data", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "i", ",", "j", ",", "3"}], "]"}], 
                   "]"}]}], "]"}]}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"par1", "\[Rule]", 
                  RowBox[{"array1", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
                 RowBox[{"par2", "\[Rule]", 
                  RowBox[{"array2", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}]}], "}"}]}], "]"}], "]"}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "imax1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "imax2", ",", "1"}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"datak", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"array1", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"array2", "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", 
           RowBox[{"Simplify", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"keq", "/.", "paramsDrop"}], "/.", 
              RowBox[{"MakeRule", "[", 
               RowBox[{"vars", ",", 
                RowBox[{"data", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "i", ",", "j", ",", "3"}], "]"}], 
                 "]"}]}], "]"}]}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"par1", "\[Rule]", 
                RowBox[{"array1", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
               RowBox[{"par2", "\[Rule]", 
                RowBox[{"array2", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}]}], "}"}]}], "]"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "imax1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "imax2", ",", "1"}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dataK", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"array1", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"array2", "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", 
           RowBox[{"Simplify", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Keq", "/.", "paramsDrop"}], "/.", 
              RowBox[{"MakeRule", "[", 
               RowBox[{"vars", ",", 
                RowBox[{"data", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "i", ",", " ", "j", ",", "3"}], "]"}], 
                 "]"}]}], "]"}]}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"par1", "\[Rule]", 
                RowBox[{"array1", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
               RowBox[{"par2", "\[Rule]", 
                RowBox[{"array2", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}]}], "}"}]}], "]"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "imax1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "imax2", ",", "1"}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"datafe", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"array1", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"array2", "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", 
           RowBox[{"Simplify", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"fe", "/.", "paramsDrop"}], "/.", 
              RowBox[{"MakeRule", "[", 
               RowBox[{"vars", ",", 
                RowBox[{"data", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "i", ",", " ", "j", ",", "3"}], "]"}], 
                 "]"}]}], "]"}]}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"par1", "\[Rule]", 
                RowBox[{"array1", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
               RowBox[{"par2", "\[Rule]", 
                RowBox[{"array2", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}]}], "}"}]}], "]"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "imax1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "imax2", ",", "1"}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "data", ",", "dataH", ",", "datak", ",", "dataK", ",", " ", "datafe"}],
        "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetStrengthOfStabDisSel", "[", 
    RowBox[{"H_", ",", "veq_", ",", " ", "oeq_", ",", "\[Tau]eq_"}], "]"}], ":=",
    "\n", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "loH", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"veq", ">", "0"}], "&&", 
         RowBox[{"oeq", ">", "0"}], "&&", 
         RowBox[{"\[Tau]eq", ">", "0"}]}], ",", 
        RowBox[{"loH", "=", 
         RowBox[{"Max", "[", 
          RowBox[{"Eigenvalues", "[", "H", "]"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"veq", "==", "0"}], "&&", 
         RowBox[{"oeq", ">", "0"}], "&&", 
         RowBox[{"\[Tau]eq", ">", "0"}]}], ",", 
        RowBox[{"loH", "=", 
         RowBox[{"Max", "[", 
          RowBox[{"Eigenvalues", "[", 
           RowBox[{"H", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"All", ";;", "2"}], ",", 
              RowBox[{"All", ";;", "2"}]}], "]"}], "]"}], "]"}], "]"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"veq", ">", "0"}], "&&", 
         RowBox[{"oeq", "==", "0"}], "&&", 
         RowBox[{"\[Tau]eq", ">", "0"}]}], ",", 
        RowBox[{"loH", "=", 
         RowBox[{"Max", "[", 
          RowBox[{"Eigenvalues", "[", 
           RowBox[{"H", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}], "]"}], 
          "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"veq", ">", "0"}], "&&", 
         RowBox[{"oeq", ">", "0"}], "&&", 
         RowBox[{"\[Tau]eq", "==", "0"}]}], ",", 
        RowBox[{"loH", "=", 
         RowBox[{"Max", "[", 
          RowBox[{"Eigenvalues", "[", 
           RowBox[{"H", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}], "]"}], 
          "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"veq", ">", "0"}], "&&", 
         RowBox[{"oeq", "==", "0"}], "&&", 
         RowBox[{"\[Tau]eq", "==", "0"}]}], ",", 
        RowBox[{"loH", "=", 
         RowBox[{"H", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"veq", "==", "0"}], "&&", 
         RowBox[{"oeq", ">", "0"}], "&&", 
         RowBox[{"\[Tau]eq", "==", "0"}]}], ",", 
        RowBox[{"loH", "=", 
         RowBox[{"H", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"veq", "==", "0"}], "&&", 
         RowBox[{"oeq", "==", "00"}], "&&", 
         RowBox[{"\[Tau]eq", ">", "0"}]}], ",", 
        RowBox[{"loH", "=", 
         RowBox[{"H", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"veq", "==", "0"}], "&&", 
         RowBox[{"oeq", "==", "00"}], "&&", 
         RowBox[{"\[Tau]eq", "==", "0"}]}], ",", 
        RowBox[{"loH", "=", 
         RowBox[{"-", "10"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "loH"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetrILtau", "[", 
    RowBox[{"H_", ",", "veq_", ",", " ", "oeq_", ",", "\[Tau]eq_"}], "]"}], ":=",
    "\n", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "loH", ",", "A", ",", "rILtau", ",", "Gtau", ",", "GIL", ",", 
       "CovIltau"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"loH", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"Eigenvalues", "[", "H", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"veq", ">", "0"}], "&&", 
         RowBox[{"oeq", ">", "0"}], "&&", 
         RowBox[{"\[Tau]eq", ">", "0"}], "&&", 
         RowBox[{"loH", "<", "0"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"A", "=", 
          RowBox[{"MatrixPower", "[", 
           RowBox[{
            RowBox[{"Inverse", "[", 
             RowBox[{"Simplify", "[", 
              RowBox[{"-", "H"}], "]"}], "]"}], ",", 
            RowBox[{"1", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Gtau", "=", 
          RowBox[{"A", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"GIL", "=", 
          RowBox[{
           RowBox[{"A", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
           RowBox[{"A", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"A", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"CovIltau", "=", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"A", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "3"}], "]"}], "]"}]}], "-", 
           RowBox[{"A", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "3"}], "]"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"rILtau", "=", 
          RowBox[{"CovIltau", "/", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"Gtau", " ", "GIL"}], "]"}]}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"rILtau", "=", "NA"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "rILtau"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetrVLtau", "[", 
    RowBox[{"H_", ",", "veq_", ",", " ", "oeq_", ",", "\[Tau]eq_"}], "]"}], ":=",
    "\n", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "loH", ",", "A", ",", "rVLtau", ",", "Gtau", ",", "GVL", ",", 
       "CovVltau"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"loH", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"Eigenvalues", "[", "H", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"veq", ">", "0"}], "&&", 
         RowBox[{"oeq", ">", "0"}], "&&", 
         RowBox[{"\[Tau]eq", ">", "0"}], "&&", 
         RowBox[{"loH", "<", "0"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"A", "=", 
          RowBox[{"MatrixPower", "[", 
           RowBox[{
            RowBox[{"Inverse", "[", 
             RowBox[{"Simplify", "[", 
              RowBox[{"-", "H"}], "]"}], "]"}], ",", 
            RowBox[{"1", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Gtau", "=", 
          RowBox[{"A", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"GVL", "=", 
          RowBox[{"A", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"CovVltau", "=", 
          RowBox[{"A", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"rVLtau", "=", 
          RowBox[{"CovVltau", "/", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"Gtau", " ", "GVL"}], "]"}]}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"rVLtau", "=", "NA"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "rVLtau"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetrOLtau", "[", 
   RowBox[{"H_", ",", "veq_", ",", " ", "oeq_", ",", "\[Tau]eq_"}], "]"}], ":=",
   "\n", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "loH", ",", "A", ",", "rOLtau", ",", "Gtau", ",", "GOL", ",", 
      "CovOltau"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"loH", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"Eigenvalues", "[", "H", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"veq", ">", "0"}], "&&", 
        RowBox[{"oeq", ">", "0"}], "&&", 
        RowBox[{"\[Tau]eq", ">", "0"}], "&&", 
        RowBox[{"loH", "<", "0"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"A", "=", 
         RowBox[{"MatrixPower", "[", 
          RowBox[{
           RowBox[{"Inverse", "[", 
            RowBox[{"Simplify", "[", 
             RowBox[{"-", "H"}], "]"}], "]"}], ",", 
           RowBox[{"1", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Gtau", "=", 
         RowBox[{"A", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"GOL", "=", 
         RowBox[{"A", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"CovOltau", "=", 
         RowBox[{"A", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rOLtau", "=", 
         RowBox[{"CovOltau", "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"Gtau", " ", "GOL"}], "]"}]}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"rOLtau", "=", "NA"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "rOLtau"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get2ParamImpactLogScaleOneDimTwoPhases", "[", 
   RowBox[{
   "S_", ",", "H_", ",", " ", "keq_", ",", " ", "Keq_", ",", "fe_", ",", " ", 
    "traits_", ",", " ", "params_", ",", " ", "param1_", ",", " ", 
    "param2_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "vars", ",", "par1", ",", "par2", ",", "paramsDrop", ",", " ", "dataInt",
       ",", "data", ",", "datak", ",", "dataK", ",", "dataH", ",", "datafe", 
      ",", " ", "imax1", ",", " ", "imax2", ",", " ", "array1", ",", "array2",
       ",", " ", "datatraits", ",", " ", "data2ndS", ",", " ", "dataA", ",", 
      "  ", "datarILtau", ",", " ", "datarOLtau", ",", " ", "datarVLtau"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"vars", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"First", "[", "#", "]"}], "&"}], ",", " ", "traits"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"par1", "=", 
      RowBox[{"param1", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"par2", "=", 
      RowBox[{"param2", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"paramsDrop", "=", 
      RowBox[{"DropParam", "[", 
       RowBox[{
        RowBox[{"DropParam", "[", 
         RowBox[{"params", ",", "par1"}], "]"}], ",", "par2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"LaunchKernels", "[", "10", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"imax1", "=", " ", 
      RowBox[{"param1", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"array1", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Exp", "[", "i", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", 
          RowBox[{"Log", "[", 
           RowBox[{"param1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "  ", 
          RowBox[{"Log", "[", 
           RowBox[{"param1", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Log", "[", 
              RowBox[{"param1", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "]"}], "-", 
             RowBox[{"Log", "[", 
              RowBox[{"param1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"param1", "[", 
              RowBox[{"[", "4", "]"}], "]"}], "-", "1"}], ")"}]}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"imax2", "=", " ", 
      RowBox[{"param2", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"array2", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", 
          RowBox[{"param2", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "  ", 
          RowBox[{"param2", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"param2", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "-", 
             RowBox[{"param2", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"param2", "[", 
              RowBox[{"[", "4", "]"}], "]"}], "-", "1"}], ")"}]}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"dataInt", " ", "=", " ", 
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"array1", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"array2", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"GetReachedStratTwoPhases", "[", 
           RowBox[{"S", ",", " ", "traits", ",", " ", 
            RowBox[{"Flatten", "[", " ", 
             RowBox[{"Insert", "[", 
              RowBox[{"paramsDrop", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"par1", "\[Rule]", 
                  RowBox[{"array1", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
                 RowBox[{"par2", "\[Rule]", 
                  RowBox[{"array2", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}]}], "}"}], ",", 
               RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "imax1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "imax2", ",", "1"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"data", " ", "=", " ", 
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"array1", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"array2", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"dataInt", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "3", ",", "k"}], "]"}], "]"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", 
          RowBox[{"Length", "[", "S", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "imax1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "imax2", ",", "1"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"data2ndS", " ", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"array1", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"array2", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"GetStrengthOfStabDisSel", "[", 
           RowBox[{
            RowBox[{"Simplify", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"H", "/.", "paramsDrop"}], "/.", 
               RowBox[{"MakeRule", "[", 
                RowBox[{"vars", ",", 
                 RowBox[{"data", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "i", ",", "j", ",", "3"}], "]"}], 
                  "]"}]}], "]"}]}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"par1", "\[Rule]", 
                 RowBox[{"array1", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
                RowBox[{"par2", "\[Rule]", 
                 RowBox[{"array2", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}]}], "}"}]}], "]"}], ",", 
            RowBox[{"v", "/.", 
             RowBox[{"MakeRule", "[", 
              RowBox[{"vars", ",", 
               RowBox[{"data", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "i", ",", "j", ",", "3"}], "]"}], 
                "]"}]}], "]"}]}], ",", " ", 
            RowBox[{"o", "/.", 
             RowBox[{"MakeRule", "[", 
              RowBox[{"vars", ",", 
               RowBox[{"data", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "i", ",", "j", ",", "3"}], "]"}], 
                "]"}]}], "]"}]}], ",", 
            RowBox[{"\[Tau]", "/.", 
             RowBox[{"MakeRule", "[", 
              RowBox[{"vars", ",", 
               RowBox[{"data", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "i", ",", "j", ",", "3"}], "]"}], 
                "]"}]}], "]"}]}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "imax1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "imax2", ",", "1"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"dataH", " ", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"array1", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"array2", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"H", "/.", "paramsDrop"}], "/.", 
             RowBox[{"MakeRule", "[", 
              RowBox[{"vars", ",", 
               RowBox[{"data", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "i", ",", "j", ",", "3"}], "]"}], 
                "]"}]}], "]"}]}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"par1", "\[Rule]", 
               RowBox[{"array1", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
              RowBox[{"par2", "\[Rule]", 
               RowBox[{"array2", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}]}], "}"}]}], "]"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "imax1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "imax2", ",", "1"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"dataA", " ", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"array1", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"array2", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"MatrixPower", "[", 
           RowBox[{
            RowBox[{"Inverse", "[", 
             RowBox[{"Simplify", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"-", "H"}], "/.", "paramsDrop"}], "/.", 
                RowBox[{"MakeRule", "[", 
                 RowBox[{"vars", ",", 
                  RowBox[{"data", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "i", ",", "j", ",", "3"}], "]"}], 
                   "]"}]}], "]"}]}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"par1", "\[Rule]", 
                  RowBox[{"array1", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
                 RowBox[{"par2", "\[Rule]", 
                  RowBox[{"array2", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}]}], "}"}]}], "]"}], "]"}], 
            ",", 
            RowBox[{"1", "/", "2"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "imax1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "imax2", ",", "1"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"datarILtau", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"array1", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"array2", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"GetrILtau", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"H", "/.", "paramsDrop"}], "/.", 
              RowBox[{"MakeRule", "[", 
               RowBox[{"vars", ",", 
                RowBox[{"data", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "i", ",", "j", ",", "3"}], "]"}], 
                 "]"}]}], "]"}]}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"par1", "\[Rule]", 
                RowBox[{"array1", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
               RowBox[{"par2", "\[Rule]", 
                RowBox[{"array2", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}]}], "}"}]}], ",", 
            RowBox[{"v", "/.", 
             RowBox[{"MakeRule", "[", 
              RowBox[{"vars", ",", 
               RowBox[{"data", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "i", ",", "j", ",", "3"}], "]"}], 
                "]"}]}], "]"}]}], ",", " ", 
            RowBox[{"o", "/.", 
             RowBox[{"MakeRule", "[", 
              RowBox[{"vars", ",", 
               RowBox[{"data", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "i", ",", "j", ",", "3"}], "]"}], 
                "]"}]}], "]"}]}], ",", 
            RowBox[{"\[Tau]", "/.", 
             RowBox[{"MakeRule", "[", 
              RowBox[{"vars", ",", 
               RowBox[{"data", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "i", ",", "j", ",", "3"}], "]"}], 
                "]"}]}], "]"}]}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "imax1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "imax2", ",", "1"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"datarOLtau", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"array1", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"array2", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"GetrOLtau", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"H", "/.", "paramsDrop"}], "/.", 
              RowBox[{"MakeRule", "[", 
               RowBox[{"vars", ",", 
                RowBox[{"data", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "i", ",", "j", ",", "3"}], "]"}], 
                 "]"}]}], "]"}]}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"par1", "\[Rule]", 
                RowBox[{"array1", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
               RowBox[{"par2", "\[Rule]", 
                RowBox[{"array2", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}]}], "}"}]}], ",", 
            RowBox[{"v", "/.", 
             RowBox[{"MakeRule", "[", 
              RowBox[{"vars", ",", 
               RowBox[{"data", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "i", ",", "j", ",", "3"}], "]"}], 
                "]"}]}], "]"}]}], ",", " ", 
            RowBox[{"o", "/.", 
             RowBox[{"MakeRule", "[", 
              RowBox[{"vars", ",", 
               RowBox[{"data", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "i", ",", "j", ",", "3"}], "]"}], 
                "]"}]}], "]"}]}], ",", 
            RowBox[{"\[Tau]", "/.", 
             RowBox[{"MakeRule", "[", 
              RowBox[{"vars", ",", 
               RowBox[{"data", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "i", ",", "j", ",", "3"}], "]"}], 
                "]"}]}], "]"}]}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "imax1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "imax2", ",", "1"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"datarVLtau", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"array1", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"array2", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"GetrVLtau", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"H", "/.", "paramsDrop"}], "/.", 
              RowBox[{"MakeRule", "[", 
               RowBox[{"vars", ",", 
                RowBox[{"data", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "i", ",", "j", ",", "3"}], "]"}], 
                 "]"}]}], "]"}]}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"par1", "\[Rule]", 
                RowBox[{"array1", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
               RowBox[{"par2", "\[Rule]", 
                RowBox[{"array2", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}]}], "}"}]}], ",", 
            RowBox[{"v", "/.", 
             RowBox[{"MakeRule", "[", 
              RowBox[{"vars", ",", 
               RowBox[{"data", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "i", ",", "j", ",", "3"}], "]"}], 
                "]"}]}], "]"}]}], ",", " ", 
            RowBox[{"o", "/.", 
             RowBox[{"MakeRule", "[", 
              RowBox[{"vars", ",", 
               RowBox[{"data", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "i", ",", "j", ",", "3"}], "]"}], 
                "]"}]}], "]"}]}], ",", 
            RowBox[{"\[Tau]", "/.", 
             RowBox[{"MakeRule", "[", 
              RowBox[{"vars", ",", 
               RowBox[{"data", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "i", ",", "j", ",", "3"}], "]"}], 
                "]"}]}], "]"}]}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "imax1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "imax2", ",", "1"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"datak", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"array1", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"array2", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"keq", "/.", "paramsDrop"}], "/.", 
             RowBox[{"MakeRule", "[", 
              RowBox[{"vars", ",", 
               RowBox[{"data", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "i", ",", "j", ",", "3"}], "]"}], 
                "]"}]}], "]"}]}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"par1", "\[Rule]", 
               RowBox[{"array1", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
              RowBox[{"par2", "\[Rule]", 
               RowBox[{"array2", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}]}], "}"}]}], "]"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "imax1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "imax2", ",", "1"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"dataK", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"array1", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"array2", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Keq", "/.", "paramsDrop"}], "/.", 
             RowBox[{"MakeRule", "[", 
              RowBox[{"vars", ",", 
               RowBox[{"data", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "i", ",", " ", "j", ",", "3"}], "]"}], 
                "]"}]}], "]"}]}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"par1", "\[Rule]", 
               RowBox[{"array1", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
              RowBox[{"par2", "\[Rule]", 
               RowBox[{"array2", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}]}], "}"}]}], "]"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "imax1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "imax2", ",", "1"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"datafe", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"array1", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"array2", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"fe", "/.", "paramsDrop"}], "/.", 
             RowBox[{"MakeRule", "[", 
              RowBox[{"vars", ",", 
               RowBox[{"data", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "i", ",", " ", "j", ",", "3"}], "]"}], 
                "]"}]}], "]"}]}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"par1", "\[Rule]", 
               RowBox[{"array1", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
              RowBox[{"par2", "\[Rule]", 
               RowBox[{"array2", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}]}], "}"}]}], "]"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "imax1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "imax2", ",", "1"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "data", ",", "dataH", ",", "datak", ",", "dataK", ",", " ", "datafe", 
       ",", "data2ndS", ",", " ", "dataA", ",", " ", "datarILtau", ",", " ", 
       "datarOLtau", ",", " ", "datarVLtau"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.915095470778927*^9, 3.9150955978839903`*^9}, {
   3.9150957032016573`*^9, 3.915095981811215*^9}, {3.915097769717593*^9, 
   3.915097793202559*^9}, 3.915097840035996*^9, {3.9150981610337763`*^9, 
   3.91509816197309*^9}, {3.915098213356852*^9, 3.915098231107373*^9}, {
   3.9150982630556383`*^9, 3.915098276675901*^9}, {3.915098652362026*^9, 
   3.915098720142407*^9}, {3.915098854466127*^9, 3.915098889605082*^9}, {
   3.9150990685231323`*^9, 3.915099074107669*^9}, 3.9150991623824587`*^9, {
   3.915167178948948*^9, 3.915167180522403*^9}, {3.915173912527836*^9, 
   3.915173914591155*^9}, {3.915175037290475*^9, 3.915175043974923*^9}, {
   3.9157874357114763`*^9, 3.9157874814734097`*^9}, {3.915787516728698*^9, 
   3.915787560553815*^9}, {3.919335214405531*^9, 3.919335233774849*^9}, {
   3.920687954322157*^9, 3.9206879557795057`*^9}, {3.9206879923841467`*^9, 
   3.92068807844272*^9}, {3.920688305341419*^9, 3.9206883139303417`*^9}, {
   3.920688476804635*^9, 3.920688513921541*^9}, {3.921048074818944*^9, 
   3.921048176705449*^9}, {3.921048223137714*^9, 3.9210483591962957`*^9}, {
   3.9210494594477673`*^9, 3.921049481043559*^9}, {3.921050705037402*^9, 
   3.9210507274529943`*^9}, {3.921051151532626*^9, 3.921051279240735*^9}, {
   3.921051366644177*^9, 3.921051403454136*^9}, {3.921051475949748*^9, 
   3.921051501278264*^9}, {3.921051533165847*^9, 3.921051549464491*^9}, {
   3.92105160079027*^9, 3.921051621648436*^9}, {3.9210516822681837`*^9, 
   3.921051682646831*^9}, {3.921052972051445*^9, 3.9210529881506433`*^9}, {
   3.921053254241095*^9, 3.921053318119452*^9}, {3.921053356639558*^9, 
   3.921053359318182*^9}, {3.921053403172304*^9, 3.921053441836722*^9}, {
   3.9210534793458357`*^9, 3.9210535001213512`*^9}, {3.921053729184875*^9, 
   3.921053766087905*^9}, {3.921053808979538*^9, 3.9210539009731693`*^9}, {
   3.921054113042996*^9, 3.921054165460352*^9}, {3.921054203629406*^9, 
   3.9210542385795927`*^9}, 3.921073403814941*^9, {3.9210734397303658`*^9, 
   3.921073601511374*^9}, {3.921122771887347*^9, 3.921122777804963*^9}, {
   3.921127697432848*^9, 3.92112774635224*^9}, {3.9212066146874037`*^9, 
   3.921206650966146*^9}, {3.927792375905456*^9, 3.9277923869670773`*^9}, {
   3.927792590286846*^9, 3.9277926724795218`*^9}, {3.927792738792326*^9, 
   3.927792778305354*^9}, {3.927793449756179*^9, 3.927793472607843*^9}, {
   3.927793807617763*^9, 3.927793820195208*^9}, {3.9277941340059566`*^9, 
   3.927794144484178*^9}, {3.9277951453010387`*^9, 3.927795151155572*^9}, {
   3.927891821662656*^9, 3.927891898236196*^9}, {3.9278919860950127`*^9, 
   3.927892003968562*^9}, {3.927892062690316*^9, 3.92789212344495*^9}, {
   3.9278979829819508`*^9, 3.927897988161407*^9}, {3.9278996008659573`*^9, 
   3.927899682049858*^9}, {3.9279614118404408`*^9, 3.92796141262328*^9}, {
   3.942456779310348*^9, 3.942456780233522*^9}, {3.942485524685727*^9, 
   3.942485524718566*^9}, 3.942485582122117*^9, 3.942486362326765*^9, {
   3.942491652692472*^9, 3.942491678338759*^9}, 3.942491824342552*^9, {
   3.9428114367884207`*^9, 3.942811437766677*^9}, {3.942811909129475*^9, 
   3.9428119112707157`*^9}, {3.942811945889739*^9, 3.9428119471004333`*^9}, {
   3.9428119852532673`*^9, 
   3.9428119894173927`*^9}},ExpressionUUID->"751129f5-7c0c-402d-8c81-\
e3e7d2ef610a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PlotLearningDynAtEq", "[", 
   RowBox[{"S_", ",", "traits_", ",", "params_", ",", 
    RowBox[{"IS_", ":", 
     RowBox[{"35", " ", "cm"}]}], ",", 
    RowBox[{"Thickness1_", ":", "0.005"}], ",", 
    RowBox[{"Thickness2_", ":", "0.0025"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "eq", ",", "vars", ",", "Keq", ",", "keq", ",", "k", ",", "tswitch1", 
      ",", "tswitch2", ",", "p1", ",", "p21", ",", "p22", ",", "p23", ",", 
      "p21bis", ",", "p22bis", ",", "p23bis", ",", "p2", ",", "style"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"style", "=", 
      RowBox[{"Directive", "[", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "40"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Extract", " ", "variable", " ", "names", " ", "from", " ", "traits"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"vars", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"First", ",", "traits"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Calculate", " ", "equilibrium", " ", "strategies"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"eq", "=", 
      RowBox[{"GetReachedStrat", "[", 
       RowBox[{"S", ",", "traits", ",", "params"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Compute", " ", "Keq", " ", "using", " ", "equilibrium", " ", 
       "strategies", " ", "and", " ", "parameters"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Keq", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Alpha]", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", "o", "-", "v"}], ")"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"\[Epsilon]", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Rho]"}], ")"}]}], ")"}]}], "/.", " ", 
        RowBox[{"MakeRule", "[", 
         RowBox[{"vars", ",", "eq"}], "]"}]}], "/.", " ", "params"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Compute", " ", "keq", " ", "using", " ", "equilibrium", " ", 
       "strategies", " ", "and", " ", "parameters"}], "*)"}], 
     RowBox[{"keq", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Alpha]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", "v", "-", "o"}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Epsilon]"}], ")"}], " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Alpha]", " ", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "o", "-", "v"}], ")"}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "\[Rho]"}], ")"}]}], ")"}]}], " ", 
             RowBox[{"\[Xi]o", "[", "o", "]"}]}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Epsilon]"}], ")"}], " ", 
             RowBox[{"\[Xi]v", "[", 
              RowBox[{"v", ",", "\[Tau]"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"\[Xi]o", "[", "o", "]"}]}], ")"}]}]}], ")"}]}], "/.", 
         " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Xi]o", "[", "o", "]"}], "->", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"E", "^", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "\[Beta]o"}], " ", "o"}], ")"}]}]}], ")"}]}], 
           ",", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Xi]v", "[", 
              RowBox[{"v", ",", "\[Tau]"}], "]"}], "->", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"E", "^", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "v"}], " ", 
                  RowBox[{"\[Beta]v", "[", "\[Tau]", "]"}]}], ")"}]}]}], 
              ")"}]}], "/.", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[Beta]v", "[", "\[Tau]", "]"}], "->", 
              RowBox[{"\[Beta]v0", "+", 
               RowBox[{"\[Beta]\[Tau]", " ", "\[Tau]"}]}]}], "}"}]}]}], 
          "}"}]}], "/.", " ", 
        RowBox[{"MakeRule", "[", 
         RowBox[{"vars", ",", "eq"}], "]"}]}], "/.", " ", "params"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Define", " ", "the", " ", "function", " ", 
       RowBox[{"k", "[", "t", "]"}]}], "*)"}], 
     RowBox[{
      RowBox[{"k", "[", "t_", "]"}], ":=", 
      RowBox[{"Evaluate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"t", "<", "v"}], ",", 
              RowBox[{
               RowBox[{"E", "^", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "t"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Beta]\[Tau]", " ", "\[Tau]"}], "+", 
                    "\[Beta]v0"}], ")"}]}], ")"}]}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"E", "^", 
                  RowBox[{"(", 
                   RowBox[{"t", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Beta]\[Tau]", " ", "\[Tau]"}], "+", 
                    "\[Beta]v0"}], ")"}]}], ")"}]}]}], ")"}], " ", "kpop", 
               " ", 
               RowBox[{"(", 
                RowBox[{"1", "-", "\[Epsilon]"}], ")"}]}], ",", 
              RowBox[{"v", "<", "t", "<", 
               RowBox[{"o", "+", "v"}]}], ",", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"E", "^", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"t", "-", "v"}], ")"}]}], " ", "\[Beta]o"}], 
                  ")"}]}]}], " ", 
               RowBox[{"(", 
                RowBox[{"K", "-", 
                 RowBox[{
                  RowBox[{"E", "^", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "-", "v"}], ")"}], " ", "\[Beta]o"}], 
                    ")"}]}], " ", "K"}], "-", "k0", "-", 
                 RowBox[{"K", " ", "\[Epsilon]"}], "+", 
                 RowBox[{
                  RowBox[{"E", "^", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "-", "v"}], ")"}], " ", "\[Beta]o"}], 
                    ")"}]}], " ", "K", " ", "\[Epsilon]"}]}], ")"}]}], ",", 
              RowBox[{
               RowBox[{"o", "+", "v"}], "<", "t", "<=", "1"}], ",", 
              RowBox[{"k1", "+", 
               RowBox[{"\[Alpha]", " ", 
                RowBox[{"(", 
                 RowBox[{"t", "-", "o", "-", "v"}], ")"}]}]}]}], "]"}], "//.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"k0", "->", 
               RowBox[{
                RowBox[{"E", "^", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "v"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Beta]\[Tau]", " ", "\[Tau]"}], "+", 
                    "\[Beta]v0"}], ")"}]}], ")"}]}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"E", "^", 
                   RowBox[{"(", 
                    RowBox[{"v", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Beta]\[Tau]", " ", "\[Tau]"}], "+", 
                    "\[Beta]v0"}], ")"}]}], ")"}]}]}], ")"}], " ", "kpop", 
                " ", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "\[Epsilon]"}], ")"}]}]}], ",", 
              RowBox[{"k1", "->", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"E", "^", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "o"}], " ", "\[Beta]o"}], ")"}]}]}], " ", 
                RowBox[{"(", 
                 RowBox[{"K", "-", 
                  RowBox[{
                   RowBox[{"E", "^", 
                    RowBox[{"(", 
                    RowBox[{"o", " ", "\[Beta]o"}], ")"}]}], " ", "K"}], "-", 
                  "k0", "-", 
                  RowBox[{"K", " ", "\[Epsilon]"}], "+", 
                  RowBox[{
                   RowBox[{"E", "^", 
                    RowBox[{"(", 
                    RowBox[{"o", " ", "\[Beta]o"}], ")"}]}], " ", "K", " ", 
                   "\[Epsilon]"}]}], ")"}]}]}]}], "}"}]}], "/.", " ", 
           RowBox[{"MakeRule", "[", 
            RowBox[{"vars", ",", "eq"}], "]"}]}], "/.", " ", "params"}], "/.",
          " ", 
         RowBox[{"kpop", "->", "keq"}]}], "/.", " ", 
        RowBox[{"K", "->", "Keq"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Define", " ", "learning", " ", "rate", " ", "functions"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"learnrateVL", "[", "t_", "]"}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Beta]\[Tau]", " ", "\[Tau]"}], "+", "\[Beta]v0"}], 
          ")"}], " ", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "\[Epsilon]"}], ")"}], " ", "keq"}], "-", 
             RowBox[{"k", "[", "t", "]"}]}], ")"}], ",", "0"}], "]"}]}], "/.",
         " ", 
        RowBox[{"MakeRule", "[", 
         RowBox[{"vars", ",", "eq"}], "]"}]}], "/.", " ", "params"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"learnrateOL", "[", "t_", "]"}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Beta]o", " ", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "\[Epsilon]"}], ")"}], " ", "Keq"}], "-", 
             RowBox[{"k", "[", "t", "]"}]}], ")"}], ",", "0"}], "]"}]}], "/.",
         " ", 
        RowBox[{"MakeRule", "[", 
         RowBox[{"vars", ",", "eq"}], "]"}]}], "/.", " ", "params"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"learnrateIL", "[", "t_", "]"}], ":=", 
      RowBox[{
       RowBox[{"\[Alpha]", "/.", " ", 
        RowBox[{"MakeRule", "[", 
         RowBox[{"vars", ",", "eq"}], "]"}]}], "/.", " ", "params"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Find", " ", "switching", " ", "times", " ", "between", " ", "learning",
        " ", "rates"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"tswitch1", "=", 
        RowBox[{
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"learnrateVL", "[", "t", "]"}], "==", 
            RowBox[{"learnrateOL", "[", "t", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "0", ",", "1"}], "}"}]}], "]"}], "[", 
         
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"tswitch2", "=", 
        RowBox[{
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"learnrateOL", "[", "t", "]"}], "==", 
            RowBox[{"learnrateIL", "[", "t", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "0", ",", "1"}], "}"}]}], "]"}], "[", 
         
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"tswitch1", "=", 
      RowBox[{"v", "/.", " ", 
       RowBox[{"MakeRule", "[", 
        RowBox[{"vars", ",", "eq"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tswitch2", "=", 
      RowBox[{
       RowBox[{"v", "+", "o"}], "/.", " ", 
       RowBox[{"MakeRule", "[", 
        RowBox[{"vars", ",", "eq"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Plot", " ", 
        RowBox[{"k", "[", "t", "]"}], " ", "with", " ", "color"}], "-", 
       RowBox[{"coded", " ", "regions"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"p1", "=", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"k", "[", "t", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"ColorFunction", "\[Rule]", 
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", "x", "}"}], ",", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"x", " ", "<", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"v", " ", "/.", " ", 
                RowBox[{"MakeRule", "[", 
                 RowBox[{"vars", ",", "eq"}], "]"}]}], "]"}]}], ",", 
             "colorVL", ",", 
             RowBox[{
              RowBox[{"Evaluate", "[", 
               RowBox[{"v", " ", "/.", " ", 
                RowBox[{"MakeRule", "[", 
                 RowBox[{"vars", ",", "eq"}], "]"}]}], "]"}], "<=", "x", "<", 
              
              RowBox[{"Evaluate", "[", 
               RowBox[{
                RowBox[{"o", " ", "+", "v"}], "/.", " ", 
                RowBox[{"MakeRule", "[", 
                 RowBox[{"vars", ",", "eq"}], "]"}]}], "]"}]}], ",", 
             "colorOL", ",", 
             RowBox[{"x", ">=", 
              RowBox[{"Evaluate", "[", 
               RowBox[{
                RowBox[{"o", "+", "v"}], " ", "/.", " ", 
                RowBox[{"MakeRule", "[", 
                 RowBox[{"vars", ",", "eq"}], "]"}]}], "]"}]}], ",", 
             "colorIL"}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"AspectRatio", "\[Rule]", 
         RowBox[{"1", "/", "2.5"}]}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "style"}], ",", 
        RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Quality\>\""}], ",", 
        RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
        RowBox[{"FillingStyle", "\[Rule]", "gray"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Thickness", "[", "Thickness1", "]"}]}], ",", 
        RowBox[{"Frame", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"True", ",", "True"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "IS"}], ",", 
        RowBox[{"Ticks", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"All", ",", "All"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "All"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
           RowBox[{"Darker", "[", "Gray", "]"}]}], "]"}]}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", "Black"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Plot", " ", "learning", " ", "rates", " ", "before", " ", "the", " ", 
       "first", " ", "switch"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"p21", "=", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"learnrateVL", "[", "t", "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "tswitch1"}], "}"}], ",", 
        RowBox[{"AspectRatio", "->", 
         RowBox[{"1", "/", "2.5"}]}], ",", 
        RowBox[{"ImageSize", "->", "Large"}], ",", 
        RowBox[{"PerformanceGoal", "->", "\"\<Quality\>\""}], ",", 
        RowBox[{"PlotStyle", "->", 
         RowBox[{"{", 
          RowBox[{"Directive", "[", 
           RowBox[{"colorVL", ",", 
            RowBox[{"Dashing", "[", 
             RowBox[{"{", 
              RowBox[{"0.01", ",", "0.005"}], "}"}], "]"}], ",", 
            RowBox[{"Thickness", "[", "Thickness1", "]"}]}], "]"}], "}"}]}], 
        ",", 
        RowBox[{"Frame", "->", "True"}], ",", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{
           RowBox[{"Dashing", "[", 
            RowBox[{"{", 
             RowBox[{"0.01", ",", "0.005"}], "}"}], "]"}], ",", 
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
           RowBox[{"Darker", "[", "Gray", "]"}]}], "]"}]}], ",", 
        RowBox[{"PlotRange", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "All"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "IS"}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", "Black"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"p21bis", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"t", ",", 
              RowBox[{"learnrateOL", "[", "t", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", "tswitch1", ",", "0.035"}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"t", ",", 
              RowBox[{"learnrateIL", "[", "t", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", "tswitch1", ",", "0.035"}], "}"}]}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"AspectRatio", "->", 
         RowBox[{"1", "/", "2.5"}]}], ",", 
        RowBox[{"ImageSize", "->", "Large"}], ",", 
        RowBox[{"PerformanceGoal", "->", "\"\<Quality\>\""}], ",", 
        RowBox[{"PlotStyle", "->", 
         RowBox[{"{", 
          RowBox[{"colorOL", ",", "colorIL"}], "}"}]}], ",", 
        RowBox[{"Frame", "->", "True"}], ",", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{
           RowBox[{"Dashing", "[", 
            RowBox[{"{", 
             RowBox[{"0.01", ",", "0.005"}], "}"}], "]"}], ",", 
           RowBox[{"Thickness", "[", "Thickness2", "]"}], ",", 
           "Mathematicagray"}], "]"}]}], ",", 
        RowBox[{"PlotRange", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "All"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "IS"}], ",", " ", 
        RowBox[{"PlotMarkers", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[FilledCircle]", ",", "6"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[FilledCircle]", ",", "6"}], "}"}]}], "}"}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Plot", " ", "learning", " ", "rates", " ", "between", " ", "the", " ", 
       "first", " ", "and", " ", "second", " ", "switch"}], "*)"}], "\n", 
     RowBox[{"p22", "=", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"learnrateOL", "[", "t", "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "tswitch1", ",", "tswitch2"}], "}"}], ",", 
        RowBox[{"AspectRatio", "->", 
         RowBox[{"1", "/", "2.5"}]}], ",", 
        RowBox[{"ImageSize", "->", "Large"}], ",", 
        RowBox[{"PerformanceGoal", "->", "\"\<Quality\>\""}], ",", 
        RowBox[{"PlotStyle", "->", 
         RowBox[{"{", 
          RowBox[{"Directive", "[", 
           RowBox[{"colorOL", ",", 
            RowBox[{"Dashing", "[", 
             RowBox[{"{", 
              RowBox[{"0.01", ",", "0.005"}], "}"}], "]"}], ",", 
            RowBox[{"Thickness", "[", "Thickness2", "]"}]}], "]"}], "}"}]}], 
        ",", 
        RowBox[{"ImageSize", "\[Rule]", "IS"}], ",", 
        RowBox[{"Frame", "->", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"p22bis", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"t", ",", 
              RowBox[{"learnrateVL", "[", "t", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "tswitch1", ",", "tswitch2", ",", "0.035"}], 
             "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"t", ",", 
              RowBox[{"learnrateIL", "[", "t", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "tswitch1", ",", "tswitch2", ",", "0.035"}], 
             "}"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"AspectRatio", "->", 
         RowBox[{"1", "/", "2.5"}]}], ",", 
        RowBox[{"ImageSize", "->", "Large"}], ",", 
        RowBox[{"PerformanceGoal", "->", "\"\<Quality\>\""}], ",", 
        RowBox[{"PlotStyle", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Directive", "[", "colorVL", "]"}], ",", 
           RowBox[{"Directive", "[", "colorIL", "]"}]}], "}"}]}], ",", 
        RowBox[{"Frame", "->", "True"}], ",", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{
           RowBox[{"Dashing", "[", 
            RowBox[{"{", 
             RowBox[{"0.01", ",", "0.005"}], "}"}], "]"}], ",", 
           RowBox[{"Thickness", "[", "Thickness2", "]"}], ",", 
           "Mathematicagray"}], "]"}]}], ",", 
        RowBox[{"PlotRange", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "All"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "IS"}], ",", " ", 
        RowBox[{"PlotMarkers", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[FilledCircle]", ",", "6"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[FilledCircle]", ",", "6"}], "}"}]}], "}"}]}]}], 
       "]"}]}], ";", "\n", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Plot", " ", "learning", " ", "rates", " ", "after", " ", "the", " ", 
       "second", " ", "switch"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"p23", "=", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"learnrateIL", "[", "t", "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "tswitch2", ",", "1"}], "}"}], ",", 
        RowBox[{"AspectRatio", "->", 
         RowBox[{"1", "/", "2.5"}]}], ",", 
        RowBox[{"ImageSize", "->", "Large"}], ",", 
        RowBox[{"PerformanceGoal", "->", "\"\<Quality\>\""}], ",", 
        RowBox[{"PlotStyle", "->", 
         RowBox[{"{", 
          RowBox[{"Directive", "[", 
           RowBox[{"colorIL", ",", 
            RowBox[{"Dashing", "[", 
             RowBox[{"{", 
              RowBox[{"0.01", ",", "0.005"}], "}"}], "]"}], ",", 
            RowBox[{"Thickness", "[", "Thickness2", "]"}]}], "]"}], "}"}]}], 
        ",", 
        RowBox[{"ImageSize", "\[Rule]", "IS"}], ",", 
        RowBox[{"Frame", "->", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"p23bis", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"t", ",", 
              RowBox[{"learnrateVL", "[", "t", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "tswitch2", ",", "1", ",", "0.035"}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"t", ",", 
              RowBox[{"learnrateOL", "[", "t", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "tswitch2", ",", "1", ",", "0.035"}], "}"}]}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"AspectRatio", "->", 
         RowBox[{"1", "/", "2.5"}]}], ",", 
        RowBox[{"ImageSize", "->", "Large"}], ",", 
        RowBox[{"PerformanceGoal", "->", "\"\<Quality\>\""}], ",", 
        RowBox[{"PlotStyle", "->", 
         RowBox[{"{", 
          RowBox[{"colorVL", ",", "colorOL"}], "}"}]}], ",", 
        RowBox[{"Frame", "->", "True"}], ",", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{
           RowBox[{"Dashing", "[", 
            RowBox[{"{", 
             RowBox[{"0.01", ",", "0.005"}], "}"}], "]"}], ",", 
           RowBox[{"Thickness", "[", "Thickness2", "]"}], ",", 
           "Mathematicagray"}], "]"}]}], ",", 
        RowBox[{"PlotRange", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "All"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "IS"}], ",", " ", 
        RowBox[{"PlotMarkers", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[FilledCircle]", ",", "6"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[FilledCircle]", ",", "6"}], "}"}]}], "}"}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Combine", " ", "all", " ", "learning", " ", "rate", " ", "plots"}], 
      "*)"}], "\n", 
     RowBox[{"p2", "=", 
      RowBox[{"Show", "[", 
       RowBox[{
       "p21", ",", "p21bis", ",", "p22", ",", "p22bis", ",", "p23", ",", 
        "p23bis"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Return", " ", "both", " ", "the", " ", 
       RowBox[{"k", "[", "t", "]"}], " ", "plot", " ", "and", " ", "the", " ",
        "combined", " ", "learning", " ", "rate", " ", "plot"}], "*)"}], "\n", 
     RowBox[{"{", 
      RowBox[{"p1", ",", "p2"}], "}"}]}]}], "\n", "]"}]}]], "Input",
 CellChangeTimes->{{3.920001582176279*^9, 3.920001594418388*^9}, {
   3.92000163003335*^9, 3.920001720343113*^9}, {3.920001755795794*^9, 
   3.920001765010293*^9}, {3.920001808626109*^9, 3.920001878315571*^9}, 
   3.920001962794286*^9, {3.920002039402976*^9, 3.9200020558733473`*^9}, {
   3.9200021318369293`*^9, 3.9200021373884373`*^9}, {3.920002209314467*^9, 
   3.92000224698197*^9}, {3.920002444016892*^9, 3.920002472562418*^9}, {
   3.920003203377344*^9, 3.920003218624015*^9}, {3.9200038819394207`*^9, 
   3.920003919030301*^9}, {3.920003986560644*^9, 3.920004001322981*^9}, 
   3.9200044244731207`*^9, {3.920090053049388*^9, 3.9200900825834846`*^9}, {
   3.920090148965108*^9, 3.920090156520226*^9}, {3.9200901952482557`*^9, 
   3.920090234048355*^9}, {3.920090269828766*^9, 3.920090295211357*^9}, {
   3.920090366645924*^9, 3.920090385090857*^9}, {3.920090508863812*^9, 
   3.920090704438483*^9}, {3.92009074614994*^9, 3.9200908988568373`*^9}, {
   3.920090934504274*^9, 3.920090971532424*^9}, {3.920091047991395*^9, 
   3.920091075939369*^9}, {3.9200911288779583`*^9, 3.92009116313864*^9}, 
   3.920091284860158*^9, {3.920103649296574*^9, 3.9201036627452173`*^9}, {
   3.920125450667357*^9, 3.920125469941935*^9}, {3.9201255050753508`*^9, 
   3.92012550657189*^9}, 3.920125664770858*^9, 3.920125695860526*^9, {
   3.920125997268417*^9, 3.92012600622493*^9}, {3.920533293157473*^9, 
   3.920533311700242*^9}, {3.920533493883669*^9, 3.920533529996004*^9}, 
   3.920533581124569*^9, {3.920533620653269*^9, 3.920533622187978*^9}, 
   3.920533686616324*^9, {3.920533768247402*^9, 3.920533774016246*^9}, {
   3.9205338927253838`*^9, 3.920533912011807*^9}, {3.920534085639097*^9, 
   3.9205343478283033`*^9}, {3.920534436556899*^9, 3.9205344867437353`*^9}, {
   3.920534528370929*^9, 3.920534917776148*^9}, {3.921121060741544*^9, 
   3.921121075773939*^9}, 3.9211229157545433`*^9, 3.921158945098227*^9, {
   3.921159262941111*^9, 3.9211592858844833`*^9}, {3.9211593713383083`*^9, 
   3.921159397290544*^9}, {3.924581707382056*^9, 3.9245817410088367`*^9}, {
   3.9278916761367197`*^9, 3.9278916886585207`*^9}, {3.9424567805074368`*^9, 
   3.9424567808100653`*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"0c042cbe-3162-4a7d-ae60-32a39ce58395"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"PlotLearningDynAtEqVLIL", "[", 
    RowBox[{"S_", ",", "traits_", ",", "params_", ",", 
     RowBox[{"IS_", ":", 
      RowBox[{"35", " ", "cm"}]}], ",", 
     RowBox[{"Thickness1_", ":", "0.005"}], ",", 
     RowBox[{"Thickness2_", ":", "0.0025"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "eq", ",", "vars", ",", "Keq", ",", "keq", ",", "k", ",", "tswitch1", 
       ",", "tswitch2", ",", "pVL1", ",", "pVL2", ",", "pOL", ",", "pIL1", 
       ",", "pIL2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Extract", " ", "variable", " ", "names", " ", "from", " ", "traits"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"vars", "=", 
       RowBox[{"Map", "[", 
        RowBox[{"First", ",", "traits"}], "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Calculate", " ", "equilibrium", " ", "strategies"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"eq", "=", 
       RowBox[{"GetReachedStrat", "[", 
        RowBox[{"S", ",", "traits", ",", "params"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Compute", " ", "Keq", " ", "using", " ", "equilibrium", " ", 
        "strategies", " ", "and", " ", "parameters"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Keq", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Alpha]", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", "o", "-", "v"}], ")"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"\[Epsilon]", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Rho]"}], ")"}]}], ")"}]}], "/.", " ", 
         RowBox[{"MakeRule", "[", 
          RowBox[{"vars", ",", "eq"}], "]"}]}], "/.", " ", "params"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Compute", " ", "keq", " ", "using", " ", "equilibrium", " ", 
        "strategies", " ", "and", " ", "parameters"}], "*)"}], 
      RowBox[{"keq", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Alpha]", " ", 
              RowBox[{"(", 
               RowBox[{"1", "-", "v", "-", "o"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "\[Epsilon]"}], ")"}], " ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"\[Alpha]", " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", "o", "-", "v"}], ")"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"\[Epsilon]", " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", "\[Rho]"}], ")"}]}], ")"}]}], " ", 
              RowBox[{"\[Xi]o", "[", "o", "]"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "\[Epsilon]"}], ")"}], " ", 
              RowBox[{"\[Xi]v", "[", 
               RowBox[{"v", ",", "\[Tau]"}], "]"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"\[Xi]o", "[", "o", "]"}]}], ")"}]}]}], ")"}]}], "/.",
           " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Xi]o", "[", "o", "]"}], "->", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"E", "^", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "\[Beta]o"}], " ", "o"}], ")"}]}]}], ")"}]}], 
            ",", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Xi]v", "[", 
               RowBox[{"v", ",", "\[Tau]"}], "]"}], "->", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"E", "^", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "v"}], " ", 
                   RowBox[{"\[Beta]v", "[", "\[Tau]", "]"}]}], ")"}]}]}], 
               ")"}]}], "/.", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Beta]v", "[", "\[Tau]", "]"}], "->", 
               RowBox[{"\[Beta]v0", "+", 
                RowBox[{"\[Beta]\[Tau]", " ", "\[Tau]"}]}]}], "}"}]}]}], 
           "}"}]}], "/.", " ", 
         RowBox[{"MakeRule", "[", 
          RowBox[{"vars", ",", "eq"}], "]"}]}], "/.", " ", "params"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Define", " ", "the", " ", "function", " ", 
        RowBox[{"k", "[", "t", "]"}]}], "*)"}], 
      RowBox[{
       RowBox[{"k", "[", "t_", "]"}], ":=", 
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{"t", "<", "v"}], ",", 
               RowBox[{
                RowBox[{"E", "^", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "t"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Beta]\[Tau]", " ", "\[Tau]"}], "+", 
                    "\[Beta]v0"}], ")"}]}], ")"}]}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"E", "^", 
                   RowBox[{"(", 
                    RowBox[{"t", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Beta]\[Tau]", " ", "\[Tau]"}], "+", 
                    "\[Beta]v0"}], ")"}]}], ")"}]}]}], ")"}], " ", "kpop", 
                " ", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "\[Epsilon]"}], ")"}]}], ",", 
               RowBox[{"v", "<", "t", "<", 
                RowBox[{"o", "+", "v"}]}], ",", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"E", "^", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"t", "-", "v"}], ")"}]}], " ", "\[Beta]o"}], 
                   ")"}]}]}], " ", 
                RowBox[{"(", 
                 RowBox[{"K", "-", 
                  RowBox[{
                   RowBox[{"E", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "-", "v"}], ")"}], " ", "\[Beta]o"}], 
                    ")"}]}], " ", "K"}], "-", "k0", "-", 
                  RowBox[{"K", " ", "\[Epsilon]"}], "+", 
                  RowBox[{
                   RowBox[{"E", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "-", "v"}], ")"}], " ", "\[Beta]o"}], 
                    ")"}]}], " ", "K", " ", "\[Epsilon]"}]}], ")"}]}], ",", 
               RowBox[{
                RowBox[{"o", "+", "v"}], "<", "t", "<=", "1"}], ",", 
               RowBox[{"k1", "+", 
                RowBox[{"\[Alpha]", " ", 
                 RowBox[{"(", 
                  RowBox[{"t", "-", "o", "-", "v"}], ")"}]}]}]}], "]"}], "//.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"k0", "->", 
                RowBox[{
                 RowBox[{"E", "^", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "v"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Beta]\[Tau]", " ", "\[Tau]"}], "+", 
                    "\[Beta]v0"}], ")"}]}], ")"}]}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   RowBox[{"E", "^", 
                    RowBox[{"(", 
                    RowBox[{"v", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Beta]\[Tau]", " ", "\[Tau]"}], "+", 
                    "\[Beta]v0"}], ")"}]}], ")"}]}]}], ")"}], " ", "kpop", 
                 " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", "\[Epsilon]"}], ")"}]}]}], ",", 
               RowBox[{"k1", "->", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"E", "^", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "o"}], " ", "\[Beta]o"}], ")"}]}]}], " ", 
                 RowBox[{"(", 
                  RowBox[{"K", "-", 
                   RowBox[{
                    RowBox[{"E", "^", 
                    RowBox[{"(", 
                    RowBox[{"o", " ", "\[Beta]o"}], ")"}]}], " ", "K"}], "-", 
                   "k0", "-", 
                   RowBox[{"K", " ", "\[Epsilon]"}], "+", 
                   RowBox[{
                    RowBox[{"E", "^", 
                    RowBox[{"(", 
                    RowBox[{"o", " ", "\[Beta]o"}], ")"}]}], " ", "K", " ", 
                    "\[Epsilon]"}]}], ")"}]}]}]}], "}"}]}], "/.", " ", 
            RowBox[{"MakeRule", "[", 
             RowBox[{"vars", ",", "eq"}], "]"}]}], "/.", " ", "params"}], "/.",
           " ", 
          RowBox[{"kpop", "->", "keq"}]}], "/.", " ", 
         RowBox[{"K", "->", "Keq"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Define", " ", "learning", " ", "rate", " ", "functions"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"learnrateVL", "[", "t_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Beta]\[Tau]", " ", "\[Tau]"}], "+", "\[Beta]v0"}], 
           ")"}], " ", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "\[Epsilon]"}], ")"}], " ", "keq"}], "-", 
              RowBox[{"k", "[", "t", "]"}]}], ")"}], ",", "0"}], "]"}]}], "/.",
          " ", 
         RowBox[{"MakeRule", "[", 
          RowBox[{"vars", ",", "eq"}], "]"}]}], "/.", " ", "params"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"learnrateOL", "[", "t_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Beta]o", " ", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "\[Epsilon]"}], ")"}], " ", "Keq"}], "-", 
              RowBox[{"k", "[", "t", "]"}]}], ")"}], ",", "0"}], "]"}]}], "/.",
          " ", 
         RowBox[{"MakeRule", "[", 
          RowBox[{"vars", ",", "eq"}], "]"}]}], "/.", " ", "params"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"learnrateIL", "[", "t_", "]"}], ":=", 
       RowBox[{
        RowBox[{"\[Alpha]", "/.", " ", 
         RowBox[{"MakeRule", "[", 
          RowBox[{"vars", ",", "eq"}], "]"}]}], "/.", " ", "params"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Find", " ", "switching", " ", "times", " ", "between", " ", 
        "learning", " ", "rates"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"tswitch1", "=", 
       RowBox[{
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"learnrateVL", "[", "t", "]"}], "==", 
           RowBox[{"learnrateIL", "[", "t", "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", "0", ",", "1"}], "}"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Plot", " ", 
         RowBox[{"k", "[", "t", "]"}], " ", "with", " ", "color"}], "-", 
        RowBox[{"coded", " ", "regions"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"p1", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"k", "[", "t", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"ColorFunction", "\[Rule]", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", "x", "}"}], ",", 
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"x", " ", "<", 
               RowBox[{"Evaluate", "[", 
                RowBox[{"v", " ", "/.", " ", 
                 RowBox[{"MakeRule", "[", 
                  RowBox[{"vars", ",", "eq"}], "]"}]}], "]"}]}], ",", 
              "colorVL", ",", 
              RowBox[{
               RowBox[{"Evaluate", "[", 
                RowBox[{"v", " ", "/.", " ", 
                 RowBox[{"MakeRule", "[", 
                  RowBox[{"vars", ",", "eq"}], "]"}]}], "]"}], "<=", "x", "<", 
               RowBox[{"Evaluate", "[", 
                RowBox[{
                 RowBox[{"o", " ", "+", "v"}], "/.", " ", 
                 RowBox[{"MakeRule", "[", 
                  RowBox[{"vars", ",", "eq"}], "]"}]}], "]"}]}], ",", 
              "colorOL", ",", 
              RowBox[{"x", ">=", 
               RowBox[{"Evaluate", "[", 
                RowBox[{
                 RowBox[{"o", "+", "v"}], " ", "/.", " ", 
                 RowBox[{"MakeRule", "[", 
                  RowBox[{"vars", ",", "eq"}], "]"}]}], "]"}]}], ",", 
              "colorIL"}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"AspectRatio", "\[Rule]", 
          RowBox[{"1", "/", "2.5"}]}], ",", 
         RowBox[{"LabelStyle", "\[Rule]", "style"}], ",", 
         RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Quality\>\""}], ",", 
         RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
         RowBox[{"FillingStyle", "\[Rule]", "gray"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"Thickness", "[", "Thickness1", "]"}]}], ",", 
         RowBox[{"Frame", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"True", ",", "True"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "IS"}], ",", 
         RowBox[{"Ticks", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"All", ",", "All"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "All"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"FrameStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
            RowBox[{"Darker", "[", "Gray", "]"}]}], "]"}]}], ",", 
         RowBox[{"FrameTicksStyle", "\[Rule]", "Black"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Plot", " ", "vertical", " ", "learning", " ", "rate"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"pVL1", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"learnrateVL", "[", "t", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "tswitch1"}], "}"}], ",", 
         RowBox[{"AspectRatio", "->", 
          RowBox[{"1", "/", "2.5"}]}], ",", 
         RowBox[{"ImageSize", "->", "Large"}], ",", 
         RowBox[{"PerformanceGoal", "->", "\"\<Quality\>\""}], ",", 
         RowBox[{"PlotStyle", "->", 
          RowBox[{"{", 
           RowBox[{"Directive", "[", 
            RowBox[{"colorVL", ",", 
             RowBox[{"Dashing", "[", 
              RowBox[{"{", 
               RowBox[{"0.01", ",", "0.005"}], "}"}], "]"}], ",", 
             RowBox[{"Thickness", "[", "Thickness1", "]"}]}], "]"}], "}"}]}], 
         ",", 
         RowBox[{"Frame", "->", "True"}], ",", 
         RowBox[{"FrameStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"Dashing", "[", 
             RowBox[{"{", 
              RowBox[{"0.01", ",", "0.005"}], "}"}], "]"}], ",", 
            RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
            RowBox[{"Darker", "[", "Gray", "]"}]}], "]"}]}], ",", 
         RowBox[{"PlotRange", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "All"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "IS"}], ",", 
         RowBox[{"FrameTicksStyle", "\[Rule]", "Black"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pVL2", "=", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", 
             RowBox[{"learnrateVL", "[", "t", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "tswitch1", ",", "1", ",", "0.01"}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"AspectRatio", "->", 
          RowBox[{"1", "/", "2.5"}]}], ",", 
         RowBox[{"ImageSize", "->", "Large"}], ",", 
         RowBox[{"PerformanceGoal", "->", "\"\<Quality\>\""}], ",", 
         RowBox[{"PlotStyle", "->", "colorVL"}], ",", 
         RowBox[{"Frame", "->", "True"}], ",", 
         RowBox[{"FrameStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"Dashing", "[", 
             RowBox[{"{", 
              RowBox[{"0.01", ",", "0.005"}], "}"}], "]"}], ",", 
            RowBox[{"Thickness", "[", "Thickness2", "]"}], ",", 
            "Mathematicagray"}], "]"}]}], ",", 
         RowBox[{"PlotRange", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "All"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "IS"}], ",", " ", 
         RowBox[{"PlotMarkers", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[FilledCircle]", ",", "6"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[FilledCircle]", ",", "6"}], "}"}]}], "}"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Plot", " ", "oblique", " ", "learning", " ", "rate"}], "*)"}],
       "\[IndentingNewLine]", 
      RowBox[{"pOL", "=", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", 
             RowBox[{"learnrateOL", "[", "t", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "1", ",", "0.015"}], "}"}]}], "]"}], 
         ",", 
         RowBox[{"AspectRatio", "->", 
          RowBox[{"1", "/", "2.5"}]}], ",", 
         RowBox[{"ImageSize", "->", "Large"}], ",", 
         RowBox[{"PerformanceGoal", "->", "\"\<Quality\>\""}], ",", 
         RowBox[{"PlotStyle", "->", "colorOL"}], ",", 
         RowBox[{"Frame", "->", "True"}], ",", 
         RowBox[{"FrameStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"Dashing", "[", 
             RowBox[{"{", 
              RowBox[{"0.01", ",", "0.005"}], "}"}], "]"}], ",", 
            RowBox[{"Thickness", "[", "Thickness2", "]"}], ",", 
            "Mathematicagray"}], "]"}]}], ",", 
         RowBox[{"PlotRange", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "All"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "IS"}], ",", " ", 
         RowBox[{"PlotMarkers", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[FilledCircle]", ",", "6"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[FilledCircle]", ",", "6"}], "}"}]}], "}"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Plot", " ", "individual", " ", "learning", " ", "rate"}], 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"pIL1", "=", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", 
             RowBox[{"learnrateIL", "[", "t", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "tswitch1", ",", "0.015"}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"AspectRatio", "->", 
          RowBox[{"1", "/", "2.5"}]}], ",", 
         RowBox[{"ImageSize", "->", "Large"}], ",", 
         RowBox[{"PerformanceGoal", "->", "\"\<Quality\>\""}], ",", 
         RowBox[{"PlotStyle", "->", 
          RowBox[{"{", 
           RowBox[{"colorOL", ",", "colorIL"}], "}"}]}], ",", 
         RowBox[{"Frame", "->", "True"}], ",", 
         RowBox[{"FrameStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"Dashing", "[", 
             RowBox[{"{", 
              RowBox[{"0.01", ",", "0.005"}], "}"}], "]"}], ",", 
            RowBox[{"Thickness", "[", "Thickness2", "]"}], ",", 
            "Mathematicagray"}], "]"}]}], ",", 
         RowBox[{"PlotRange", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "All"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "IS"}], ",", " ", 
         RowBox[{"PlotMarkers", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[FilledCircle]", ",", "6"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[FilledCircle]", ",", "6"}], "}"}]}], "}"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pIL2", "=", 
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"learnrateIL", "[", "t", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "tswitch1", ",", "1"}], "}"}], ",", 
         RowBox[{"AspectRatio", "->", 
          RowBox[{"1", "/", "2.5"}]}], ",", 
         RowBox[{"ImageSize", "->", "Large"}], ",", 
         RowBox[{"PerformanceGoal", "->", "\"\<Quality\>\""}], ",", 
         RowBox[{"PlotStyle", "->", 
          RowBox[{"{", 
           RowBox[{"Directive", "[", 
            RowBox[{"colorIL", ",", 
             RowBox[{"Dashing", "[", 
              RowBox[{"{", 
               RowBox[{"0.01", ",", "0.005"}], "}"}], "]"}], ",", 
             RowBox[{"Thickness", "[", "Thickness2", "]"}]}], "]"}], "}"}]}], 
         ",", 
         RowBox[{"ImageSize", "\[Rule]", "IS"}], ",", 
         RowBox[{"Frame", "->", "True"}]}], "]"}]}], ";", "\n", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Combine", " ", "all", " ", "learning", " ", "rate", " ", "plots"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"p2", "=", 
       RowBox[{"Show", "[", 
        RowBox[{"pVL1", ",", "pVL2", ",", "pOL", ",", "pIL1", ",", "pIL2"}], 
        "]"}]}], ";", "\n", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Return", " ", "both", " ", "the", " ", 
        RowBox[{"k", "[", "t", "]"}], " ", "plot", " ", "and", " ", "the", 
        " ", "combined", " ", "learning", " ", "rate", " ", "plot"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"p1", ",", "p2"}], "}"}]}]}], "\n", "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQXTvlYByL+VtHLe1X8SCa/d2TVBBdJqWaDqKnhp3M
BdH7LZ7lg+jvX2tKQHSeUh+YVs5srwHRSifm14H1u6xvAdGbuGNaQTSXdRt/
ny3QvPbvAiA6+tDTP2zxbx0Z5gj/B9E/GvlY2YH0PPFyLhBdIXldEETf2SYg
AqL9TG5IgGiryElSIPqNoqcKiE4rywfT1a9+6ILowPZ8AxBdtH+5KYiuSj0H
prdfqvMG0Q8DvQJAdMpNqVAQHZWuEgeizy3vSAbRicGbi0D0BM/mchAd9uDo
TBAtFz9rPojWZl8Cpg8c/rUYRJ/YLLscRDN9uvqWA0hPWqD7AURX3F3Mygly
385vbCDa5MesnYuBdOObRWAaABg4orQ=
  "],
 CellLabel->"In[45]:=",ExpressionUUID->"a58074d0-7d8f-4f0c-b4fc-1ea2c00bf683"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PlotLearningDynAtEqOLIL", "[", 
   RowBox[{"S_", ",", "traits_", ",", "params_", ",", 
    RowBox[{"IS_", ":", 
     RowBox[{"35", " ", "cm"}]}], ",", 
    RowBox[{"Thickness1_", ":", "0.005"}], ",", 
    RowBox[{"Thickness2_", ":", "0.0025"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "eq", ",", "vars", ",", "Keq", ",", "keq", ",", "k", ",", "tswitch1", 
      ",", "tswitch2", ",", "pVL1", ",", "pVL2", ",", "pOL1", ",", "pOL2", 
      ",", "pOL3", ",", "pIL1", ",", "pIL2"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Extract", " ", "variable", " ", "names", " ", "from", " ", "traits"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"vars", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"First", ",", "traits"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Calculate", " ", "equilibrium", " ", "strategies"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"eq", "=", 
      RowBox[{"GetReachedStrat", "[", 
       RowBox[{"S", ",", "traits", ",", "params"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Compute", " ", "Keq", " ", "using", " ", "equilibrium", " ", 
       "strategies", " ", "and", " ", "parameters"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Keq", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Alpha]", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", "o", "-", "v"}], ")"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"\[Epsilon]", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Rho]"}], ")"}]}], ")"}]}], "/.", " ", 
        RowBox[{"MakeRule", "[", 
         RowBox[{"vars", ",", "eq"}], "]"}]}], "/.", " ", "params"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Compute", " ", "keq", " ", "using", " ", "equilibrium", " ", 
       "strategies", " ", "and", " ", "parameters"}], "*)"}], 
     RowBox[{"keq", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Alpha]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", "v", "-", "o"}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Epsilon]"}], ")"}], " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Alpha]", " ", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "o", "-", "v"}], ")"}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "\[Rho]"}], ")"}]}], ")"}]}], " ", 
             RowBox[{"\[Xi]o", "[", "o", "]"}]}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Epsilon]"}], ")"}], " ", 
             RowBox[{"\[Xi]v", "[", 
              RowBox[{"v", ",", "\[Tau]"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"\[Xi]o", "[", "o", "]"}]}], ")"}]}]}], ")"}]}], "/.", 
         " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Xi]o", "[", "o", "]"}], "->", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"E", "^", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "\[Beta]o"}], " ", "o"}], ")"}]}]}], ")"}]}], 
           ",", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Xi]v", "[", 
              RowBox[{"v", ",", "\[Tau]"}], "]"}], "->", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"E", "^", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "v"}], " ", 
                  RowBox[{"\[Beta]v", "[", "\[Tau]", "]"}]}], ")"}]}]}], 
              ")"}]}], "/.", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[Beta]v", "[", "\[Tau]", "]"}], "->", 
              RowBox[{"\[Beta]v0", "+", 
               RowBox[{"\[Beta]\[Tau]", " ", "\[Tau]"}]}]}], "}"}]}]}], 
          "}"}]}], "/.", " ", 
        RowBox[{"MakeRule", "[", 
         RowBox[{"vars", ",", "eq"}], "]"}]}], "/.", " ", "params"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Define", " ", "the", " ", "function", " ", 
       RowBox[{"k", "[", "t", "]"}]}], "*)"}], 
     RowBox[{
      RowBox[{"k", "[", "t_", "]"}], ":=", 
      RowBox[{"Evaluate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"t", "<", "v"}], ",", 
              RowBox[{
               RowBox[{"E", "^", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "t"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Beta]\[Tau]", " ", "\[Tau]"}], "+", 
                    "\[Beta]v0"}], ")"}]}], ")"}]}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"E", "^", 
                  RowBox[{"(", 
                   RowBox[{"t", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Beta]\[Tau]", " ", "\[Tau]"}], "+", 
                    "\[Beta]v0"}], ")"}]}], ")"}]}]}], ")"}], " ", "kpop", 
               " ", 
               RowBox[{"(", 
                RowBox[{"1", "-", "\[Epsilon]"}], ")"}]}], ",", 
              RowBox[{"v", "<", "t", "<", 
               RowBox[{"o", "+", "v"}]}], ",", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"E", "^", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"t", "-", "v"}], ")"}]}], " ", "\[Beta]o"}], 
                  ")"}]}]}], " ", 
               RowBox[{"(", 
                RowBox[{"K", "-", 
                 RowBox[{
                  RowBox[{"E", "^", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "-", "v"}], ")"}], " ", "\[Beta]o"}], 
                    ")"}]}], " ", "K"}], "-", "k0", "-", 
                 RowBox[{"K", " ", "\[Epsilon]"}], "+", 
                 RowBox[{
                  RowBox[{"E", "^", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"t", "-", "v"}], ")"}], " ", "\[Beta]o"}], 
                    ")"}]}], " ", "K", " ", "\[Epsilon]"}]}], ")"}]}], ",", 
              RowBox[{
               RowBox[{"o", "+", "v"}], "<", "t", "<=", "1"}], ",", 
              RowBox[{"k1", "+", 
               RowBox[{"\[Alpha]", " ", 
                RowBox[{"(", 
                 RowBox[{"t", "-", "o", "-", "v"}], ")"}]}]}]}], "]"}], "//.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"k0", "->", 
               RowBox[{
                RowBox[{"E", "^", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "v"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Beta]\[Tau]", " ", "\[Tau]"}], "+", 
                    "\[Beta]v0"}], ")"}]}], ")"}]}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"E", "^", 
                   RowBox[{"(", 
                    RowBox[{"v", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Beta]\[Tau]", " ", "\[Tau]"}], "+", 
                    "\[Beta]v0"}], ")"}]}], ")"}]}]}], ")"}], " ", "kpop", 
                " ", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "\[Epsilon]"}], ")"}]}]}], ",", 
              RowBox[{"k1", "->", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"E", "^", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "o"}], " ", "\[Beta]o"}], ")"}]}]}], " ", 
                RowBox[{"(", 
                 RowBox[{"K", "-", 
                  RowBox[{
                   RowBox[{"E", "^", 
                    RowBox[{"(", 
                    RowBox[{"o", " ", "\[Beta]o"}], ")"}]}], " ", "K"}], "-", 
                  "k0", "-", 
                  RowBox[{"K", " ", "\[Epsilon]"}], "+", 
                  RowBox[{
                   RowBox[{"E", "^", 
                    RowBox[{"(", 
                    RowBox[{"o", " ", "\[Beta]o"}], ")"}]}], " ", "K", " ", 
                   "\[Epsilon]"}]}], ")"}]}]}]}], "}"}]}], "/.", " ", 
           RowBox[{"MakeRule", "[", 
            RowBox[{"vars", ",", "eq"}], "]"}]}], "/.", " ", "params"}], "/.",
          " ", 
         RowBox[{"kpop", "->", "keq"}]}], "/.", " ", 
        RowBox[{"K", "->", "Keq"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Define", " ", "learning", " ", "rate", " ", "functions"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"learnrateVL", "[", "t_", "]"}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Beta]\[Tau]", " ", "\[Tau]"}], "+", "\[Beta]v0"}], 
          ")"}], " ", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "\[Epsilon]"}], ")"}], " ", "keq"}], "-", 
             RowBox[{"k", "[", "t", "]"}]}], ")"}], ",", "0"}], "]"}]}], "/.",
         " ", 
        RowBox[{"MakeRule", "[", 
         RowBox[{"vars", ",", "eq"}], "]"}]}], "/.", " ", "params"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"learnrateOL", "[", "t_", "]"}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Beta]o", " ", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "\[Epsilon]"}], ")"}], " ", "Keq"}], "-", 
             RowBox[{"k", "[", "t", "]"}]}], ")"}], ",", "0"}], "]"}]}], "/.",
         " ", 
        RowBox[{"MakeRule", "[", 
         RowBox[{"vars", ",", "eq"}], "]"}]}], "/.", " ", "params"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"learnrateIL", "[", "t_", "]"}], ":=", 
      RowBox[{
       RowBox[{"\[Alpha]", "/.", " ", 
        RowBox[{"MakeRule", "[", 
         RowBox[{"vars", ",", "eq"}], "]"}]}], "/.", " ", "params"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Find", " ", "switching", " ", "times", " ", "between", " ", "learning",
        " ", "rates"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"tswitch1", "=", 
        RowBox[{
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"learnrateVL", "[", "t", "]"}], "==", 
            RowBox[{"learnrateOL", "[", "t", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "0", ",", "1"}], "}"}]}], "]"}], "[", 
         
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"tswitch2", "=", 
        RowBox[{
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"learnrateOL", "[", "t", "]"}], "==", 
            RowBox[{"learnrateIL", "[", "t", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "0", ",", "1"}], "}"}]}], "]"}], "[", 
         
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"tswitch1", "=", 
      RowBox[{"v", "/.", " ", 
       RowBox[{"MakeRule", "[", 
        RowBox[{"vars", ",", "eq"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tswitch2", "=", 
      RowBox[{
       RowBox[{"v", "+", "o"}], "/.", " ", 
       RowBox[{"MakeRule", "[", 
        RowBox[{"vars", ",", "eq"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Plot", " ", 
        RowBox[{"k", "[", "t", "]"}], " ", "with", " ", "color"}], "-", 
       RowBox[{"coded", " ", "regions"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"p1", "=", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"k", "[", "t", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"ColorFunction", "\[Rule]", 
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", "x", "}"}], ",", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"x", " ", "<", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"v", " ", "/.", " ", 
                RowBox[{"MakeRule", "[", 
                 RowBox[{"vars", ",", "eq"}], "]"}]}], "]"}]}], ",", 
             "colorVL", ",", 
             RowBox[{
              RowBox[{"Evaluate", "[", 
               RowBox[{"v", " ", "/.", " ", 
                RowBox[{"MakeRule", "[", 
                 RowBox[{"vars", ",", "eq"}], "]"}]}], "]"}], "<=", "x", "<", 
              
              RowBox[{"Evaluate", "[", 
               RowBox[{
                RowBox[{"o", " ", "+", "v"}], "/.", " ", 
                RowBox[{"MakeRule", "[", 
                 RowBox[{"vars", ",", "eq"}], "]"}]}], "]"}]}], ",", 
             "colorOL", ",", 
             RowBox[{"x", ">=", 
              RowBox[{"Evaluate", "[", 
               RowBox[{
                RowBox[{"o", "+", "v"}], " ", "/.", " ", 
                RowBox[{"MakeRule", "[", 
                 RowBox[{"vars", ",", "eq"}], "]"}]}], "]"}]}], ",", 
             "colorIL"}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"AspectRatio", "\[Rule]", 
         RowBox[{"1", "/", "2.5"}]}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "style"}], ",", 
        RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Quality\>\""}], ",", 
        RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
        RowBox[{"FillingStyle", "\[Rule]", "gray"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Thickness", "[", "Thickness1", "]"}]}], ",", 
        RowBox[{"Frame", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"True", ",", "True"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "IS"}], ",", 
        RowBox[{"Ticks", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"All", ",", "All"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "All"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
           RowBox[{"Darker", "[", "Gray", "]"}]}], "]"}]}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", "Black"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Plot", " ", "vertical", " ", "learning", " ", "rate"}], "*)"}],
      "\[IndentingNewLine]", 
     RowBox[{"pVL1", "=", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"learnrateVL", "[", "t", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "tswitch1"}], "}"}], ",", 
        RowBox[{"AspectRatio", "->", 
         RowBox[{"1", "/", "2.5"}]}], ",", 
        RowBox[{"ImageSize", "->", "Large"}], ",", 
        RowBox[{"PerformanceGoal", "->", "\"\<Quality\>\""}], ",", 
        RowBox[{"PlotStyle", "->", 
         RowBox[{"{", 
          RowBox[{"Directive", "[", 
           RowBox[{"colorVL", ",", 
            RowBox[{"Dashing", "[", 
             RowBox[{"{", 
              RowBox[{"0.01", ",", "0.005"}], "}"}], "]"}], ",", 
            RowBox[{"Thickness", "[", "Thickness1", "]"}]}], "]"}], "}"}]}], 
        ",", 
        RowBox[{"Frame", "->", "True"}], ",", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{
           RowBox[{"Dashing", "[", 
            RowBox[{"{", 
             RowBox[{"0.01", ",", "0.005"}], "}"}], "]"}], ",", 
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
           RowBox[{"Darker", "[", "Gray", "]"}]}], "]"}]}], ",", 
        RowBox[{"PlotRange", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "15"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "IS"}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", "Black"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pVL2", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t", ",", 
            RowBox[{"learnrateVL", "[", "t", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "tswitch1", ",", "1", ",", "0.01"}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"AspectRatio", "->", 
         RowBox[{"1", "/", "2.5"}]}], ",", 
        RowBox[{"ImageSize", "->", "Large"}], ",", 
        RowBox[{"PerformanceGoal", "->", "\"\<Quality\>\""}], ",", 
        RowBox[{"PlotStyle", "->", "colorVL"}], ",", 
        RowBox[{"Frame", "->", "True"}], ",", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{
           RowBox[{"Dashing", "[", 
            RowBox[{"{", 
             RowBox[{"0.01", ",", "0.005"}], "}"}], "]"}], ",", 
           RowBox[{"Thickness", "[", "Thickness2", "]"}], ",", 
           "Mathematicagray"}], "]"}]}], ",", 
        RowBox[{"PlotRange", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "20"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "IS"}], ",", " ", 
        RowBox[{"PlotMarkers", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[FilledCircle]", ",", "6"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[FilledCircle]", ",", "6"}], "}"}]}], "}"}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Plot", " ", "oblique", " ", "learning", " ", "rate"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"pOL1", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t", ",", 
            RowBox[{"learnrateOL", "[", "t", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", "tswitch1", ",", "0.015"}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"AspectRatio", "->", 
         RowBox[{"1", "/", "2.5"}]}], ",", 
        RowBox[{"ImageSize", "->", "Large"}], ",", 
        RowBox[{"PerformanceGoal", "->", "\"\<Quality\>\""}], ",", 
        RowBox[{"PlotStyle", "->", "colorOL"}], ",", 
        RowBox[{"Frame", "->", "True"}], ",", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{
           RowBox[{"Dashing", "[", 
            RowBox[{"{", 
             RowBox[{"0.01", ",", "0.005"}], "}"}], "]"}], ",", 
           RowBox[{"Thickness", "[", "Thickness2", "]"}], ",", 
           "Mathematicagray"}], "]"}]}], ",", 
        RowBox[{"PlotRange", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "All"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "IS"}], ",", " ", 
        RowBox[{"PlotMarkers", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[FilledCircle]", ",", "6"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[FilledCircle]", ",", "6"}], "}"}]}], "}"}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pOL2", "=", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"learnrateOL", "[", "t", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "tswitch1", ",", "tswitch2"}], "}"}], ",", 
        RowBox[{"AspectRatio", "->", 
         RowBox[{"1", "/", "2.5"}]}], ",", 
        RowBox[{"ImageSize", "->", "Large"}], ",", 
        RowBox[{"PerformanceGoal", "->", "\"\<Quality\>\""}], ",", 
        RowBox[{"PlotStyle", "->", 
         RowBox[{"{", 
          RowBox[{"Directive", "[", 
           RowBox[{"colorOL", ",", 
            RowBox[{"Dashing", "[", 
             RowBox[{"{", 
              RowBox[{"0.01", ",", "0.005"}], "}"}], "]"}], ",", 
            RowBox[{"Thickness", "[", "Thickness1", "]"}]}], "]"}], "}"}]}], 
        ",", 
        RowBox[{"Frame", "->", "True"}], ",", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{
           RowBox[{"Dashing", "[", 
            RowBox[{"{", 
             RowBox[{"0.01", ",", "0.005"}], "}"}], "]"}], ",", 
           RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
           RowBox[{"Darker", "[", "Gray", "]"}]}], "]"}]}], ",", 
        RowBox[{"PlotRange", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "All"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "IS"}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", "Black"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pOL3", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t", ",", 
            RowBox[{"learnrateOL", "[", "t", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "tswitch2", ",", "1", ",", "0.015"}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"AspectRatio", "->", 
         RowBox[{"1", "/", "2.5"}]}], ",", 
        RowBox[{"ImageSize", "->", "Large"}], ",", 
        RowBox[{"PerformanceGoal", "->", "\"\<Quality\>\""}], ",", 
        RowBox[{"PlotStyle", "->", "colorOL"}], ",", 
        RowBox[{"Frame", "->", "True"}], ",", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{
           RowBox[{"Dashing", "[", 
            RowBox[{"{", 
             RowBox[{"0.01", ",", "0.005"}], "}"}], "]"}], ",", 
           RowBox[{"Thickness", "[", "Thickness2", "]"}], ",", 
           "Mathematicagray"}], "]"}]}], ",", 
        RowBox[{"PlotRange", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "All"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "IS"}], ",", " ", 
        RowBox[{"PlotMarkers", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[FilledCircle]", ",", "6"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[FilledCircle]", ",", "6"}], "}"}]}], "}"}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Plot", " ", "individual", " ", "learning", " ", "rate"}], 
      "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"pIL1", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t", ",", 
            RowBox[{"learnrateIL", "[", "t", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", "tswitch2", ",", "0.017"}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"AspectRatio", "->", 
         RowBox[{"1", "/", "2.5"}]}], ",", 
        RowBox[{"ImageSize", "->", "Large"}], ",", 
        RowBox[{"PerformanceGoal", "->", "\"\<Quality\>\""}], ",", 
        RowBox[{"PlotStyle", "->", 
         RowBox[{"{", 
          RowBox[{"colorOL", ",", "colorIL"}], "}"}]}], ",", 
        RowBox[{"Frame", "->", "True"}], ",", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{
           RowBox[{"Dashing", "[", 
            RowBox[{"{", 
             RowBox[{"0.01", ",", "0.005"}], "}"}], "]"}], ",", 
           RowBox[{"Thickness", "[", "Thickness2", "]"}], ",", 
           "Mathematicagray"}], "]"}]}], ",", 
        RowBox[{"PlotRange", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "All"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "IS"}], ",", " ", 
        RowBox[{"PlotMarkers", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[FilledCircle]", ",", "6"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[FilledCircle]", ",", "6"}], "}"}]}], "}"}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pIL2", "=", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"learnrateIL", "[", "t", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "tswitch2", ",", "1"}], "}"}], ",", 
        RowBox[{"AspectRatio", "->", 
         RowBox[{"1", "/", "2.5"}]}], ",", 
        RowBox[{"ImageSize", "->", "Large"}], ",", 
        RowBox[{"PerformanceGoal", "->", "\"\<Quality\>\""}], ",", 
        RowBox[{"PlotStyle", "->", 
         RowBox[{"{", 
          RowBox[{"Directive", "[", 
           RowBox[{"colorIL", ",", 
            RowBox[{"Dashing", "[", 
             RowBox[{"{", 
              RowBox[{"0.01", ",", "0.005"}], "}"}], "]"}], ",", 
            RowBox[{"Thickness", "[", "Thickness2", "]"}]}], "]"}], "}"}]}], 
        ",", 
        RowBox[{"ImageSize", "\[Rule]", "IS"}], ",", 
        RowBox[{"Frame", "->", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Combine", " ", "all", " ", "learning", " ", "rate", " ", "plots"}], 
      "*)"}], "\n", 
     RowBox[{"p2", "=", 
      RowBox[{"Show", "[", 
       RowBox[{"pVL2", ",", "pOL2", ",", "pOL3", ",", "pIL1", ",", "pIL2"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Return", " ", "both", " ", "the", " ", 
       RowBox[{"k", "[", "t", "]"}], " ", "plot", " ", "and", " ", "the", " ",
        "combined", " ", "learning", " ", "rate", " ", "plot"}], "*)"}], "\n", 
     RowBox[{"{", 
      RowBox[{"p1", ",", "p2"}], "}"}]}]}], "\n", "]"}]}]], "Input",
 CellChangeTimes->{{3.920001582176279*^9, 3.920001594418388*^9}, {
   3.92000163003335*^9, 3.920001720343113*^9}, {3.920001755795794*^9, 
   3.920001765010293*^9}, {3.920001808626109*^9, 3.920001878315571*^9}, 
   3.920001962794286*^9, {3.920002039402976*^9, 3.9200020558733473`*^9}, {
   3.9200021318369293`*^9, 3.9200021373884373`*^9}, {3.920002209314467*^9, 
   3.92000224698197*^9}, {3.920002444016892*^9, 3.920002472562418*^9}, {
   3.920003203377344*^9, 3.920003218624015*^9}, {3.9200038819394207`*^9, 
   3.920003919030301*^9}, {3.920003986560644*^9, 3.920004001322981*^9}, 
   3.9200044244731207`*^9, {3.920090053049388*^9, 3.9200900825834846`*^9}, {
   3.920090148965108*^9, 3.920090156520226*^9}, {3.9200901952482557`*^9, 
   3.920090234048355*^9}, {3.920090269828766*^9, 3.920090295211357*^9}, {
   3.920090366645924*^9, 3.920090385090857*^9}, {3.920090508863812*^9, 
   3.920090704438483*^9}, {3.92009074614994*^9, 3.9200908988568373`*^9}, {
   3.920090934504274*^9, 3.920090971532424*^9}, {3.920091047991395*^9, 
   3.920091075939369*^9}, {3.9200911288779583`*^9, 3.92009116313864*^9}, 
   3.920091284860158*^9, {3.920103649296574*^9, 3.9201036627452173`*^9}, {
   3.920125450667357*^9, 3.920125469941935*^9}, {3.9201255050753508`*^9, 
   3.92012550657189*^9}, 3.920125664770858*^9, 3.920125695860526*^9, {
   3.920125997268417*^9, 3.92012600622493*^9}, {3.920533293157473*^9, 
   3.920533311700242*^9}, {3.920533493883669*^9, 3.920533529996004*^9}, 
   3.920533581124569*^9, {3.920533620653269*^9, 3.920533622187978*^9}, 
   3.920533686616324*^9, {3.920533768247402*^9, 3.920533774016246*^9}, {
   3.9205338927253838`*^9, 3.920533912011807*^9}, {3.920534085639097*^9, 
   3.9205343478283033`*^9}, {3.920534436556899*^9, 3.9205344867437353`*^9}, {
   3.920534528370929*^9, 3.920534917776148*^9}, {3.921121060741544*^9, 
   3.921121075773939*^9}, 3.9211229157545433`*^9, 3.921158945098227*^9, {
   3.921159262941111*^9, 3.9211592858844833`*^9}, {3.9211593713383083`*^9, 
   3.921159397290544*^9}, {3.9211637708487473`*^9, 3.9211638182124157`*^9}, {
   3.921164016348483*^9, 3.921164017922147*^9}, {3.921164173241613*^9, 
   3.921164174005728*^9}, {3.924586643729329*^9, 3.9245866549546747`*^9}, {
   3.942137274016614*^9, 3.942137381923901*^9}, {3.942137430917549*^9, 
   3.942137630282942*^9}, {3.9421376848310757`*^9, 3.942137693538518*^9}, {
   3.94213773718688*^9, 3.942137748333044*^9}, {3.942137786262027*^9, 
   3.942137787714657*^9}, {3.942139703134644*^9, 3.9421397413706293`*^9}, {
   3.942139924654315*^9, 3.942139925162278*^9}, {3.942139999238789*^9, 
   3.942140014822785*^9}, {3.94245678113299*^9, 3.942456781456904*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"e3e01dbe-351a-4d0b-aaa5-b42e5f2bb34d"]
},
WindowSize->{1512, 831},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.3 pour Mac OS X ARM (64-bit) (July 24, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"28078c1b-1575-44c9-8711-f4c6d233a0a0"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1403, 37, 260, "Input",ExpressionUUID->"a0f9afcd-dd60-4da7-b40b-5f7e82d88f2f"],
Cell[1964, 59, 3193, 85, 310, "Input",ExpressionUUID->"566f8f1a-1f53-4652-bdeb-db47045c6e65"],
Cell[5160, 146, 10056, 224, 758, "Input",ExpressionUUID->"88dc340d-32af-4189-9569-9b94a0b6ea1d"],
Cell[15219, 372, 5634, 138, 448, "Input",ExpressionUUID->"25884e0c-6520-43fb-abfb-c00293331c81"],
Cell[20856, 512, 7993, 202, 586, "Input",ExpressionUUID->"e69ae01a-cf35-4f30-b1af-3d4787435a90"],
Cell[28852, 716, 46197, 1140, 3532, "Input",ExpressionUUID->"751129f5-7c0c-402d-8c81-e3e7d2ef610a"],
Cell[75052, 1858, 29638, 726, 2044, "Input",ExpressionUUID->"0c042cbe-3162-4a7d-ae60-32a39ce58395"],
Cell[104693, 2586, 24616, 604, 1846, "Input",ExpressionUUID->"a58074d0-7d8f-4f0c-b4fc-1ea2c00bf683"],
Cell[129312, 3192, 30445, 738, 2110, "Input",ExpressionUUID->"e3e01dbe-351a-4d0b-aaa5-b42e5f2bb34d"]
}
]
*)

